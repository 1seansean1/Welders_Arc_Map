<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>Satellite Visualization System</title>

    <!--
    MOBILE COMPATIBILITY NOTES:
    - viewport meta tag prevents zooming (better for map interaction)
    - Touch events supported for panel expand/collapse
    - Responsive breakpoints at 768px (tablet) and 480px (mobile)
    - Panel collapses automatically on mobile (<768px) to maximize map space
    - Touch-friendly button sizes (minimum 44x44px per iOS guidelines)
    - Uses CSS transforms for smooth 60fps animations on mobile GPUs
    -->

    <!-- Leaflet.js (for base map) - Lightweight, fast, no API token required -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
          integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY="
          crossorigin=""/>
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
            integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo="
            crossorigin=""></script>

    <!-- Deck.gl (for satellite visualization) -->
    <script src="https://unpkg.com/deck.gl@9.0.0/dist.min.js"></script>

    <!-- Deck.gl-Leaflet integration (handles sync automatically) -->
    <script src="https://unpkg.com/deck.gl-leaflet@1.3.1/dist/deck.gl-leaflet.umd.min.js"></script>

    <!-- satellite.js (for SGP4 orbital propagation) -->
    <script src="https://unpkg.com/satellite.js@5.0.0/dist/satellite.min.js"></script>

    <!-- Flatpickr datetime picker (dark theme) -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/themes/dark.css">
    <script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>

    <style>
        /* ============================================
           FLATPICKR CUSTOM SIZING
           ============================================ */

        /* Make calendar popup smaller */
        .flatpickr-calendar {
            width: 202px !important;
            font-size: 10px !important;
        }

        .flatpickr-months {
            height: 26px !important;
        }

        .flatpickr-month {
            height: 26px !important;
        }

        .flatpickr-current-month {
            font-size: 10px !important;
            height: 26px !important;
            line-height: 26px !important;
            padding: 0 !important;
        }

        .flatpickr-current-month .flatpickr-monthDropdown-months {
            font-size: 10px !important;
        }

        .flatpickr-weekdays {
            height: 22px !important;
        }

        span.flatpickr-weekday {
            font-size: 9px !important;
            height: 22px !important;
            line-height: 22px !important;
        }

        .flatpickr-days {
            width: 202px !important;
        }

        .dayContainer {
            width: 202px !important;
            min-width: 202px !important;
            max-width: 202px !important;
        }

        .flatpickr-day {
            height: 26px !important;
            line-height: 26px !important;
            max-width: 29px !important;
            font-size: 10px !important;
        }

        .flatpickr-time {
            height: 30px !important;
        }

        .flatpickr-time input {
            font-size: 10px !important;
            height: 26px !important;
        }

        .flatpickr-time .flatpickr-time-separator,
        .flatpickr-time .flatpickr-am-pm {
            font-size: 10px !important;
            height: 26px !important;
            line-height: 26px !important;
        }

        /* Time input wrappers and arrows */
        .flatpickr-time .numInputWrapper {
            height: 26px !important;
        }

        .flatpickr-time .numInputWrapper span.arrowUp,
        .flatpickr-time .numInputWrapper span.arrowDown {
            width: 10px !important;
            height: 10px !important;
            line-height: 10px !important;
        }

        .flatpickr-time .numInputWrapper span.arrowUp {
            top: 1px !important;
        }

        .flatpickr-time .numInputWrapper span.arrowDown {
            top: auto !important;
            bottom: 1px !important;
        }

        .flatpickr-time .numInputWrapper span.arrowUp:after {
            border-bottom-width: 3px !important;
            border-left: 3px solid transparent !important;
            border-right: 3px solid transparent !important;
            top: 3px !important;
        }

        .flatpickr-time .numInputWrapper span.arrowDown:after {
            border-top-width: 3px !important;
            border-left: 3px solid transparent !important;
            border-right: 3px solid transparent !important;
            top: 3px !important;
        }

        .flatpickr-prev-month,
        .flatpickr-next-month {
            height: 26px !important;
            line-height: 26px !important;
            width: 22px !important;
        }

        .flatpickr-prev-month svg,
        .flatpickr-next-month svg {
            width: 9px !important;
            height: 9px !important;
        }

        /* ============================================
           LEAFLET ZOOM CONTROL CUSTOM SIZING
           ============================================ */

        /* Compact zoom control - minimalistic design */
        .leaflet-control-zoom {
            border: 1px solid #333333 !important;
            border-radius: 3px !important;
            box-shadow: none !important;
        }

        .leaflet-control-zoom-in,
        .leaflet-control-zoom-out {
            width: 24px !important;
            height: 24px !important;
            line-height: 22px !important;
            font-size: 14px !important;
            background: #1a1a1a !important;
            color: #f5f5f5 !important;
            border: none !important;
            border-radius: 0 !important;
        }

        .leaflet-control-zoom-in {
            border-top-left-radius: 2px !important;
            border-top-right-radius: 2px !important;
            border-bottom: 1px solid #333333 !important;
        }

        .leaflet-control-zoom-out {
            border-bottom-left-radius: 2px !important;
            border-bottom-right-radius: 2px !important;
        }

        .leaflet-control-zoom-in:hover,
        .leaflet-control-zoom-out:hover {
            background: #2a2a2a !important;
            color: #9dd4ff !important;
        }

        /* Mobile: Larger touch targets (44px minimum per iOS guidelines) */
        @media (max-width: 768px) {
            .leaflet-control-zoom-in,
            .leaflet-control-zoom-out {
                width: 44px !important;
                height: 44px !important;
                line-height: 42px !important;
                font-size: 20px !important;
            }
        }

        /* ============================================
           MAP MAXIMIZE BUTTON
           ============================================ */

        /* Maximize button - positioned below zoom control */
        #map-maximize-btn {
            position: absolute;
            top: 64px;  /* Below zoom control (48px + 16px gap) */
            right: 10px;
            width: 24px;
            height: 24px;
            background: #1a1a1a;
            color: #f5f5f5;
            border: 1px solid #333333;
            border-radius: 3px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 11px;
            z-index: 1000;
            transition: background 0.2s, color 0.2s;
        }

        #map-maximize-btn:hover {
            background: #2a2a2a;
            color: #9dd4ff;
        }

        /* Fit Earth button - positioned below maximize button */
        #map-fit-earth-btn {
            position: absolute;
            top: 94px;  /* Below maximize button */
            right: 10px;
            width: 24px;
            height: 24px;
            background: #1a1a1a;
            color: #f5f5f5;
            border: 1px solid #333333;
            border-radius: 3px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            z-index: 1000;
            transition: background 0.2s, color 0.2s;
        }

        #map-fit-earth-btn:hover {
            background: #2a2a2a;
            color: #9dd4ff;
        }

        /* Mobile: Larger touch target */
        @media (max-width: 768px) {
            #map-maximize-btn {
                width: 44px;
                height: 44px;
                font-size: 20px;
                top: 104px;  /* Below larger zoom control */
            }
        }

        /* ============================================
           CURRENT TIME DISPLAY - Direct overlay on map
           ============================================ */

        .current-time-display {
            position: absolute;
            top: 4px;
            left: 4px;
            background: transparent;
            border: none;
            padding: 0;
            z-index: 1000;
            display: flex;
            flex-direction: column;
            gap: 0;
            pointer-events: none;
            text-shadow: 0 1px 3px rgba(0,0,0,0.9), 0 0 6px rgba(0,0,0,0.7);
        }

        .time-row {
            display: flex;
            align-items: center;
            gap: 4px;
        }

        .time-label {
            font-size: 9px;
            font-weight: 600;
            color: var(--text-muted);
            text-transform: uppercase;
            width: 22px;
            font-family: var(--font-sans);
        }

        .time-value {
            font-size: 10px;
            font-weight: 500;
            color: var(--text-secondary);
            font-family: var(--font-sans);
        }

        .time-value.sim-mode {
            color: #ffeb3b;  /* Yellow for simulation mode */
        }

        /* SIM label styling */
        .time-label.sim-label {
            text-transform: uppercase;
            font-weight: 700;
        }

        /* ============================================
           MAP TIME BAR (Bottom of Map) - Compact Responsive
           ============================================ */

        .map-time-bar {
            position: absolute;
            bottom: 6px;
            left: 6px;
            right: 6px;
            background: rgba(10, 10, 10, 0.92);
            border: 1px solid #333;
            border-radius: 4px;
            padding: 3px 4px;
            z-index: 1000;
            display: flex;
            align-items: center;
            gap: 2px;
            pointer-events: auto;
            font-family: 'Consolas', 'Monaco', monospace;
            overflow: hidden;
        }

        /* Group containers */
        .mtb-group {
            display: flex;
            align-items: center;
            gap: 2px;
            flex-shrink: 0;
        }

        .mtb-slider-group {
            flex: 1;
            min-width: 80px;
        }

        /* Compact buttons */
        .mtb-btn {
            background: var(--bg-secondary);
            border: 1px solid #555555;
            border-radius: 3px;
            color: var(--text-secondary);
            font-size: 9px;
            padding: 2px 4px;
            cursor: pointer;
            transition: all 0.1s ease;
            min-width: 20px;
            height: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            line-height: 1;
        }

        .mtb-btn:hover {
            background: var(--bg-tertiary);
            color: var(--text-primary);
            border-color: var(--accent-blue-grey);
        }

        .mtb-btn:active { transform: scale(0.92); }

        /* Transport controls */
        .mtb-anim {
            font-size: 8px;
            letter-spacing: -2px;
            padding: 2px 3px;
        }

        .mtb-anim.animating {
            background: var(--accent-primary);
            border-color: var(--accent-primary);
            color: var(--bg-primary);
        }

        .mtb-play {
            background: var(--accent-blue-grey);
            border-color: var(--accent-blue-grey);
            color: var(--bg-primary);
            font-size: 8px;
            min-width: 22px;
        }

        .mtb-play:hover {
            background: var(--accent-primary);
            border-color: var(--accent-primary);
        }

        .mtb-play.simulation-mode {
            background: #8b4513;
            border-color: #a0522d;
            color: #fff;
        }

        .mtb-stop { font-size: 8px; }

        .mtb-step-btn {
            font-size: 11px;
            font-weight: bold;
            min-width: 18px;
            padding: 1px 3px;
        }

        .mtb-now {
            font-size: 10px;
            min-width: 18px;
            color: var(--accent-primary);
        }

        /* Compact selects */
        .mtb-select {
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: 3px;
            color: var(--text-secondary);
            font-size: 9px;
            padding: 1px 2px;
            cursor: pointer;
            height: 20px;
            min-width: 24px;
        }

        .mtb-select:focus {
            outline: none;
            border-color: var(--accent-blue-grey);
        }

        /* Datetime inputs with Flatpickr */
        .mtb-datetime {
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: 3px;
            color: var(--text-secondary);
            font-size: 9px;
            padding: 1px 4px;
            height: 20px;
            width: 95px;
            cursor: pointer;
            text-align: center;
        }

        .mtb-datetime:focus {
            outline: none;
            border-color: var(--accent-blue-grey);
            color: var(--text-primary);
        }

        .mtb-datetime.pending {
            border-color: var(--accent-orange);
        }

        /* Compact slider */
        .mtb-slider {
            flex: 1;
            min-width: 50px;
            height: 3px;
            -webkit-appearance: none;
            appearance: none;
            background: var(--bg-tertiary);
            border-radius: 2px;
            cursor: pointer;
            margin: 0 2px;
        }

        .mtb-slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 10px;
            height: 10px;
            border-radius: 50%;
            background: var(--accent-blue-grey);
            cursor: pointer;
            border: 1px solid var(--bg-primary);
        }

        .mtb-slider::-moz-range-thumb {
            width: 10px;
            height: 10px;
            border-radius: 50%;
            background: var(--accent-blue-grey);
            cursor: pointer;
            border: 1px solid var(--bg-primary);
        }

        /* Responsive: hide elements on narrow widths */
        @media (max-width: 700px) {
            .mtb-window-group { display: none; }
        }

        @media (max-width: 500px) {
            .mtb-rate-group { display: none; }
        }

        @media (max-width: 350px) {
            .mtb-anim { display: none; }
        }

        /* Flatpickr overrides for dark theme */
        .flatpickr-calendar {
            background: var(--bg-secondary) !important;
            border: 1px solid var(--border-color) !important;
            box-shadow: 0 4px 12px rgba(0,0,0,0.5) !important;
            font-size: 11px !important;
        }

        .flatpickr-months, .flatpickr-weekdays, .flatpickr-days {
            background: var(--bg-secondary) !important;
        }

        .flatpickr-day {
            color: var(--text-secondary) !important;
            border-radius: 3px !important;
        }

        .flatpickr-day:hover {
            background: var(--bg-tertiary) !important;
            color: var(--text-primary) !important;
        }

        .flatpickr-day.selected {
            background: var(--accent-blue-grey) !important;
            border-color: var(--accent-blue-grey) !important;
        }

        .flatpickr-current-month {
            color: var(--text-primary) !important;
        }

        .flatpickr-time input {
            background: var(--bg-tertiary) !important;
            color: var(--text-primary) !important;
            border: none !important;
        }

        .numInputWrapper span {
            border-color: var(--border-color) !important;
        }

        .numInputWrapper span:hover {
            background: var(--bg-tertiary) !important;
        }

        /* Maximized state */
        #main-container.maximized {
            grid-template-columns: 100% !important;
            grid-template-rows: 100% !important;
        }

        #main-container.maximized #pane-top-right,
        #main-container.maximized #pane-bottom-left,
        #main-container.maximized #pane-bottom-right,
        #main-container.maximized .grid-resize-handle {
            display: none !important;
        }

        #main-container.maximized #pane-top-left {
            grid-column: 1;
            grid-row: 1;
        }

    </style>
    <style>
        /* ============================================
           GLOBAL STYLES - Claude/Robinhood Inspired
           ============================================ */

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            /* Color palette - Minimalist, high contrast */
            --bg-primary: #0a0a0a;
            --bg-secondary: #1a1a1a;
            --bg-tertiary: #2a2a2a;
            --border-color: #333333;
            --text-primary: #f5f5f5;
            --text-secondary: #a3a3a3;
            --text-muted: #666666;
            --accent-blue-grey: #9dd4ff;
            --accent-green: #00ff66;
            --accent-yellow: #ffeb3b;
            --accent-red: #ff4444;

            /* Panel dimensions */
            --panel-collapsed-width: 42px;
            --panel-expanded-width: 224px;
            --panel-transition: 0.27s cubic-bezier(0.4, 0.0, 0.2, 1);

            /* Mobile-specific */
            --mobile-panel-width: 240px;

            /* Typography */
            --font-mono: 'SF Mono', 'Monaco', 'Inconsolata', monospace;
            --font-sans: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
        }

        /* Light theme overrides */
        [data-theme="light"] {
            --bg-primary: #f5f5f5;
            --bg-secondary: #ffffff;
            --bg-tertiary: #e8e8e8;
            --border-color: #cccccc;
            --text-primary: #1a1a1a;
            --text-secondary: #555555;
            --text-muted: #888888;
            --accent-blue-grey: #0066cc;
            --accent-green: #00994d;
            --accent-yellow: #cc9900;
            --accent-red: #cc3333;
        }

        /* Light theme - Clock display text shadow (dark on light) */
        [data-theme="light"] .current-time-display {
            text-shadow: 0 1px 2px rgba(255,255,255,0.9), 0 0 4px rgba(255,255,255,0.7);
        }
        [data-theme="light"] .time-value {
            color: #1a1a1a;
            font-weight: 600;
        }
        [data-theme="light"] .time-label {
            color: #555555;
            font-weight: 600;
        }
        [data-theme="light"] .time-label.sim-label {
            font-weight: 600;
        }

        /* Light theme - Map time bar background */
        [data-theme="light"] .map-time-bar {
            background: rgba(255, 255, 255, 0.95);
            border-color: #cccccc;
        }

        /* Light theme - Log inline controls background */
        [data-theme="light"] .log-inline-controls {
            background: rgba(255, 255, 255, 0.92);
        }

        /* Light theme - Grid resize handle highlight (darker for visibility) */
        [data-theme="light"] .grid-resize-vertical::before {
            background: linear-gradient(180deg,
                rgba(0, 102, 204, 0.7) 0%,
                rgba(0, 130, 230, 0.85) 25%,
                rgba(0, 150, 255, 0.9) 50%,
                rgba(0, 130, 230, 0.85) 75%,
                rgba(0, 102, 204, 0.7) 100%);
        }
        [data-theme="light"] .grid-resize-horizontal::before {
            background: linear-gradient(90deg,
                rgba(0, 102, 204, 0.7) 0%,
                rgba(0, 130, 230, 0.85) 25%,
                rgba(0, 150, 255, 0.9) 50%,
                rgba(0, 130, 230, 0.85) 75%,
                rgba(0, 102, 204, 0.7) 100%);
        }

        /* Light theme - Log panel resize handle (darker for visibility) */
        [data-theme="light"] .log-resize-handle::before {
            background: linear-gradient(90deg,
                rgba(0, 102, 204, 0.7) 0%,
                rgba(0, 130, 230, 0.85) 25%,
                rgba(0, 150, 255, 0.9) 50%,
                rgba(0, 130, 230, 0.85) 75%,
                rgba(0, 102, 204, 0.7) 100%);
        }

        /* Theme transition for smooth switching */
        body, .control-panel, .panel-content, .settings-section,
        .sensor-table, .satellite-table, .log-panel, #map {
            transition: background-color 0.3s ease, color 0.3s ease, border-color 0.3s ease;
        }

        body {
            font-family: var(--font-sans);
            background: var(--bg-primary);
            color: var(--text-primary);
            overflow: hidden;
            height: 100vh;
            width: 100vw;
        }

        /* ============================================
           CONTROL PANEL - Collapsible Sidebar
           ============================================ */

        #control-panel {
            position: fixed;
            left: 0;
            top: 0;
            height: 100vh;
            width: var(--panel-collapsed-width);
            background: var(--bg-secondary);
            border-right: 1px solid var(--border-color);
            transition: width var(--panel-transition);
            z-index: 1000;
            display: flex;
            flex-direction: column;
            overflow: hidden;

            /* MOBILE: Hardware acceleration for smooth animation */
            transform: translateZ(0);
            will-change: width;
        }

        #control-panel.expanded {
            width: var(--panel-expanded-width);
        }

        /* Panel Header (top section with collapse button) */
        .panel-header {
            height: 50px;
            border-bottom: 1px solid var(--border-color);
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 0 0 0 5px;
            flex-shrink: 0;
            justify-content: flex-start;
        }

        .panel-title {
            font-size: 12px;
            font-weight: 600;
            color: var(--text-primary);
            opacity: 0;
            transition: opacity 0.2s;
            white-space: nowrap;
            display: none;
        }

        #control-panel.expanded .panel-title {
            opacity: 1;
            display: block;
        }

        .collapse-btn {
            width: 24px;
            height: 24px;
            border: none;
            background: transparent;
            color: var(--text-secondary);
            cursor: pointer;
            border-radius: 4px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s;
            flex-shrink: 0;
            position: relative;

            /* MOBILE: Larger touch target */
            min-width: 24px;
            min-height: 24px;
        }

        .collapse-btn:hover {
            background: var(--bg-tertiary);
            color: var(--text-primary);
        }

        /* Collapse button icon states */
        /* When panel is collapsed (default), show expand icon (right arrow) */
        .collapse-icon-expanded {
            display: none !important;
        }

        .collapse-icon-collapsed {
            display: block;
        }

        /* When panel is expanded, show collapse icon (left arrow) */
        #control-panel.expanded .collapse-icon-expanded {
            display: block !important;
        }

        #control-panel.expanded .collapse-icon-collapsed {
            display: none !important;
        }

        /* SVG icons inherit color for hover states */
        .nav-icon svg {
            display: block;
            flex-shrink: 0;
        }

        /* Navigation Buttons (upper portion) */
        .nav-section {
            flex: 0 0 auto;
            border-bottom: 1px solid #555555;
            padding: 2px 0;
            overflow-y: hidden;
            overflow-x: hidden;
        }

        .nav-btn {
            width: 100%;
            height: 22px;
            border: none;
            background: transparent;
            color: var(--text-secondary);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: flex-start;
            padding: 0 0 0 10px;
            gap: 5px;
            transition: none;
            position: relative;

            /* Compact button height */
            min-height: 22px;
        }

        .nav-btn:hover {
            background: var(--bg-tertiary);
            color: var(--text-primary);
        }

        .nav-btn.active {
            background: var(--bg-tertiary);
            color: var(--accent-blue-grey);
        }

        /* Ensure icon and text both inherit the active color */
        .nav-btn.active .nav-icon,
        .nav-btn.active .nav-icon svg,
        .nav-btn.active .nav-icon img,
        .nav-btn.active .nav-label {
            color: var(--accent-blue-grey);
        }

        /* Override img filter for active state */
        .nav-btn.active .nav-icon img {
            filter: invert(1) sepia(1) saturate(5) hue-rotate(175deg);
        }

        /* Light theme - Remove invert filter from nav icon images (makes them visible) */
        [data-theme="light"] .nav-icon img {
            filter: none !important;
        }
        [data-theme="light"] .nav-btn.active .nav-icon img {
            filter: sepia(1) saturate(5) hue-rotate(175deg) !important;
        }

        /* Removed the green bar ::before element */

        .nav-icon {
            font-size: 12px;
            flex-shrink: 0;
            width: 14px;
            text-align: center;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .nav-label {
            font-size: 11px;
            font-weight: 500;
            white-space: nowrap;
            display: none;
        }

        #control-panel.expanded .nav-label {
            display: block;
        }

        /* Content Area (lower 2/3) */
        .content-section {
            flex: 1;
            padding: 8px 14px 24px 14px;
            overflow-y: auto;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.2s;
        }

        #control-panel.expanded .content-section {
            opacity: 1;
            pointer-events: auto;
        }

        /* Profile Avatar Section (bottom of control panel) */
        .profile-section {
            flex-shrink: 0;
            border-top: 1px solid var(--border-color);
            padding: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        #control-panel.expanded .profile-section {
            justify-content: flex-start;
            padding: 8px 14px;
            gap: 10px;
        }

        .profile-avatar-btn {
            min-width: 24px;
            min-height: 24px;
            aspect-ratio: 1;
            flex-shrink: 0;
            width: 24px;
            height: 24px;
            border-radius: 50%;
            border: 2px solid var(--border-color);
            background: var(--bg-tertiary);
            color: var(--text-primary);
            font-size: 11px;
            font-weight: 600;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: border-color 0.2s, background 0.2s;
            text-transform: uppercase;
        }

        .profile-avatar-btn:hover {
            border-color: var(--accent-blue-grey);
            background: var(--bg-secondary);
        }

        .profile-info {
            display: none;
            flex-direction: column;
            gap: 2px;
            overflow: hidden;
        }

        #control-panel.expanded .profile-info {
            display: flex;
        }

        .profile-name {
            font-size: 12px;
            font-weight: 500;
            color: var(--text-primary);
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .profile-role {
            font-size: 10px;
            color: var(--text-muted);
            text-transform: capitalize;
        }

        /* Time Controls */
        .time-controls {
            display: flex;
            flex-direction: column;
            gap: 4px;
        }

        .time-control-group {
            display: flex;
            flex-direction: column;
            gap: 2px;
        }

        .time-label {
            font-size: 9px;
            text-transform: uppercase;
            letter-spacing: 0.3px;
            color: var(--text-primary);
            font-weight: 600;
        }

        .time-input-row {
            display: flex;
            gap: 2px;
            align-items: center;
        }

        .time-arrow-btn {
            width: 20px;
            height: 20px;
            border: 1px solid #666666;
            background: var(--bg-tertiary);
            color: var(--text-primary);
            border-radius: 3px;
            cursor: pointer;
            font-size: 9px;
            transition: none;
            flex-shrink: 0;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 0;
        }

        .time-arrow-btn:hover {
            background: var(--bg-primary);
            color: var(--text-primary);
            border-color: var(--accent-blue-grey);
        }

        .time-arrow-btn:active {
            transform: scale(0.95);
        }

        .time-input {
            flex: 0.75;
            min-width: 0;
            height: 20px;
            background: var(--bg-primary);
            border: 1px solid #666666;
            color: var(--text-primary);
            border-radius: 3px;
            padding: 0 3px;
            font-size: 8px;
            font-family: var(--font-mono);
            transition: none;
        }

        .time-input:focus {
            outline: none;
            border-color: var(--accent-blue-grey);
        }

        .time-input.pending {
            border-color: #ff9800;
        }

        .time-now-btn {
            width: 24px;
            height: 20px;
            background: var(--bg-tertiary);
            color: var(--text-primary);
            border: 1px solid #666666;
            border-radius: 3px;
            font-weight: 600;
            font-size: 7px;
            cursor: pointer;
            transition: none;
            flex-shrink: 0;
        }

        .time-now-btn:hover {
            background: var(--bg-primary);
            color: var(--text-primary);
            border-color: var(--accent-blue-grey);
        }

        .time-now-btn:active {
            transform: scale(0.95);
        }

        /* Time Action Buttons (Cancel/Apply) */
        .time-actions {
            display: flex;
            gap: 4px;
            margin-top: 6px;
            width: 85.5%;
            pointer-events: none;
            transition: none;
        }

        .time-actions.visible {
            pointer-events: auto;
        }

        .time-action-btn {
            flex: 1;
            height: 24px;
            border: none;
            border-radius: 3px;
            font-size: 9px;
            font-weight: 600;
            cursor: pointer;
            transition: none;
        }

        /* Subdued state - muted colors */
        .time-cancel-btn {
            background: #1f1f1f;
            color: #4a4a4a;
            border: 1px solid #555555;
        }

        .time-apply-btn {
            background: #2a3540;
            color: #4a5a65;
            border: 1px solid #555555;
        }

        /* Active state - full colors */
        .time-actions.visible .time-cancel-btn {
            background: var(--bg-tertiary);
            color: var(--text-primary);
            border: 1px solid #666666;
        }

        .time-actions.visible .time-apply-btn {
            background: var(--accent-blue-grey);
            color: var(--bg-primary);
        }

        /* Hover states only work when visible */
        .time-actions.visible .time-cancel-btn:hover {
            background: var(--bg-secondary);
            border-color: var(--text-secondary);
        }

        .time-actions.visible .time-apply-btn:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(157, 212, 255, 0.3);
        }

        .time-action-btn:active {
            transform: translateY(0);
        }

        /* ============================================
           TIME SLIDER CONTROLS
           ============================================ */

        .time-slider-section {
            margin-top: 8px;
            border-top: 1px solid var(--border-color);
            padding-top: 8px;
        }

        .time-slider-controls {
            display: flex;
            align-items: center;
            gap: 4px;
            margin-top: 4px;
        }

        .time-step-select {
            width: 42px;
            height: 20px;
            background: var(--bg-primary);
            border: 1px solid #666666;
            border-radius: 3px;
            color: var(--text-primary);
            font-size: 8px;
            font-family: var(--font-mono);
            cursor: pointer;
            padding: 0 2px;
        }

        .time-step-select:focus {
            outline: none;
            border-color: var(--accent-blue-grey);
        }

        .time-slider-btn {
            width: 20px;
            height: 20px;
            border: 1px solid #666666;
            background: var(--bg-tertiary);
            color: var(--text-primary);
            border-radius: 3px;
            cursor: pointer;
            font-size: 10px;
            font-weight: bold;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 0;
            flex-shrink: 0;
        }

        .time-slider-btn:hover {
            background: var(--bg-primary);
            border-color: var(--accent-blue-grey);
        }

        .time-slider-btn:active {
            transform: scale(0.95);
        }

        .time-slider {
            flex: 1;
            height: 4px;
            -webkit-appearance: none;
            appearance: none;
            background: var(--bg-tertiary);
            border-radius: 2px;
            outline: none;
            cursor: pointer;
            min-width: 40px;
        }

        .time-slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 14px;
            height: 14px;
            background: var(--accent-blue-grey);
            border-radius: 50%;
            cursor: pointer;
            transition: transform 0.1s;
        }

        .time-slider::-webkit-slider-thumb:hover {
            transform: scale(1.2);
        }

        .time-slider::-moz-range-thumb {
            width: 14px;
            height: 14px;
            background: var(--accent-blue-grey);
            border-radius: 50%;
            cursor: pointer;
            border: none;
        }

        /* Real-time mode indicator - green thumb */
        .time-slider.realtime::-webkit-slider-thumb {
            background: var(--accent-green);
        }

        .time-slider.realtime::-moz-range-thumb {
            background: var(--accent-green);
        }

        .time-slider-now-btn {
            width: 24px;
            height: 20px;
            background: var(--bg-tertiary);
            color: var(--text-primary);
            border: 1px solid #666666;
            border-radius: 3px;
            font-weight: 600;
            font-size: 7px;
            cursor: pointer;
            flex-shrink: 0;
        }

        .time-slider-now-btn:hover {
            background: var(--bg-primary);
            border-color: var(--accent-green);
            color: var(--accent-green);
        }

        .time-slider-now-btn:active {
            transform: scale(0.95);
        }

        /* ============================================
           GROUND TRACK DURATION CONTROLS
           ============================================ */

        .track-duration-section {
            margin-top: 8px;
            border-top: 1px solid var(--border-color);
            padding-top: 8px;
            padding-bottom: 16px;
        }

        .track-duration-control {
            display: flex;
            align-items: center;
            gap: 6px;
            margin-top: 4px;
        }

        .track-label {
            font-size: 8px;
            font-weight: 500;
            color: var(--text-secondary);
            width: 55px;
            min-width: 55px;
            flex-shrink: 0;
        }

        .track-slider {
            width: 80px;
            max-width: 80px;
            flex-shrink: 0;
            height: 4px;
            -webkit-appearance: none;
            appearance: none;
            background: var(--bg-tertiary);
            border-radius: 2px;
            outline: none;
            cursor: pointer;
        }

        .track-slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 12px;
            height: 12px;
            background: var(--accent-blue-grey);
            border-radius: 50%;
            cursor: pointer;
            transition: transform 0.1s;
        }

        .track-slider::-webkit-slider-thumb:hover {
            transform: scale(1.2);
        }

        .track-slider::-moz-range-thumb {
            width: 12px;
            height: 12px;
            background: var(--accent-blue-grey);
            border-radius: 50%;
            cursor: pointer;
            border: none;
        }

        .track-input {
            width: 36px;
            height: 18px;
            background: var(--bg-primary);
            border: 1px solid var(--border-color);
            border-radius: 3px;
            color: var(--text-primary);
            font-size: 9px;
            font-family: var(--font-mono);
            text-align: center;
            padding: 0 2px;
        }

        .track-input:focus {
            outline: none;
            border-color: var(--accent-blue-grey);
        }

        /* Hide spinner buttons for number input */
        .track-input::-webkit-outer-spin-button,
        .track-input::-webkit-inner-spin-button {
            -webkit-appearance: none;
            margin: 0;
        }

        .track-input[type=number] {
            -moz-appearance: textfield;
        }

        .track-unit {
            font-size: 7px;
            color: var(--text-muted);
            flex-shrink: 0;
            min-width: 45px;
        }

        .track-step-btn {
            width: 20px;
            height: 18px;
            background: var(--bg-tertiary);
            border: 1px solid var(--border-color);
            border-radius: 3px;
            color: var(--text-secondary);
            font-size: 10px;
            font-weight: bold;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.15s ease;
        }

        .track-step-btn:hover {
            background: var(--accent-blue-grey);
            border-color: var(--accent-blue-grey);
            color: var(--text-primary);
        }

        .track-step-btn:active {
            transform: scale(0.95);
        }

        /* ============================================
           SETTINGS SECTION
           ============================================ */

        .settings-section {
            margin-bottom: 16px;
        }

        .settings-row {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-top: 6px;
        }

        .settings-toggle-label {
            display: flex;
            align-items: center;
            gap: 6px;
            font-size: 9px;
            color: var(--text-primary);
            cursor: pointer;
        }

        .settings-toggle-label input[type="checkbox"] {
            width: 14px;
            height: 14px;
            cursor: pointer;
            accent-color: var(--accent-blue-grey);
        }

        /* Theme Toggle Switch */
        .theme-switch-label {
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 11px;
        }

        .theme-switch-text {
            color: var(--text-secondary);
            font-size: 11px;
            min-width: 32px;
        }

        .theme-switch {
            position: relative;
            display: inline-block;
            width: 36px;
            height: 18px;
        }

        .theme-switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }

        .theme-slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: var(--accent-blue-grey);
            transition: 0.3s;
            border-radius: 18px;
            border: 1px solid var(--accent-blue-grey);
        }

        .theme-slider:before {
            position: absolute;
            content: "";
            height: 12px;
            width: 12px;
            left: 2px;
            bottom: 2px;
            background-color: var(--bg-primary);
            transition: 0.3s;
            border-radius: 50%;
        }

        .theme-switch input:checked + .theme-slider {
            background-color: var(--accent-blue-grey);
        }

        .theme-switch input:checked + .theme-slider:before {
            transform: translateX(18px);
        }

        .theme-switch input:focus + .theme-slider {
            box-shadow: 0 0 4px var(--accent-blue-grey);
        }

        /* Light theme adjustments for toggle */
        [data-theme="light"] .theme-slider:before {
            background-color: var(--bg-primary);
        }

        .track-input-display {
            font-size: 9px;
            color: var(--text-primary);
            font-family: var(--font-mono);
            min-width: 24px;
            text-align: right;
        }

        /* ============================================
           4-PANE RESIZABLE GRID
           ============================================ */

        #main-container {
            position: fixed;
            left: var(--panel-collapsed-width);
            top: 0;
            width: calc(100vw - var(--panel-collapsed-width));
            height: 100vh;
            transition: left var(--panel-transition), width var(--panel-transition);
            display: grid;
            grid-template-columns: 65% 35%;
            grid-template-rows: 60% 40%;
            gap: 0;
            overflow: hidden;
        }

        #control-panel.expanded ~ #main-container {
            left: var(--panel-expanded-width);
            width: calc(100vw - var(--panel-expanded-width));
        }

        /* Individual panes */
        .pane {
            position: relative;
            overflow: hidden;
            border: 1px solid var(--border-color);
            background: var(--bg-primary);
        }

        #pane-top-left {
            grid-column: 1;
            grid-row: 1;
        }

        #pane-top-right {
            grid-column: 2;
            grid-row: 1;
        }

        #pane-bottom-left {
            grid-column: 1;
            grid-row: 2;
        }

        #pane-bottom-right {
            grid-column: 2;
            grid-row: 2;
        }

        /* Map container (inside top-left pane) */
        #map-container {
            position: absolute;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: #1a1a1a;  /* Dark grey background while tiles load */
        }

        /* Deck.gl canvas */
        #deck-canvas {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
        }

        /* Coming soon placeholder */
        .coming-soon {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 100%;
            height: 100%;
            font-size: 11px;
            color: var(--text-muted);
            font-weight: 500;
        }

        /* ============================================
           POLAR PLOT
           ============================================ */

        .polar-plot-container {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 100%;
            height: 100%;
            background: var(--bg-primary);
        }

        #polar-plot-canvas {
            max-width: 100%;
            max-height: 100%;
        }

        /* ============================================
           ANALYSIS PANEL
           ============================================ */

        .analysis-controls {
            padding: 8px;
        }

        .analysis-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 11px;
        }

        .analysis-table th {
            padding: 4px 2px;
            text-align: left;
            color: var(--text-muted);
            font-weight: 500;
            background: var(--bg-secondary);
            border-bottom: 1px solid #2a2a2a;
        }

        .analysis-table td {
            padding: 6px 2px;
            border-bottom: 1px solid #2a2a2a;
            color: var(--text-primary);
        }

        .analysis-table tbody tr:hover {
            background: var(--bg-tertiary);
        }

        .analysis-table label {
            cursor: pointer;
            user-select: none;
        }

        .analysis-checkbox {
            width: 14px;
            height: 14px;
            cursor: pointer;
        }

        .analysis-table .col-check {
            width: 30px;
            text-align: center;
        }

        /* ============================================
           LAMBERT PANEL
           ============================================ */

        .lambert-panel-container {
            display: flex;
            flex-direction: column;
            width: 100%;
            height: 100%;
            background: var(--bg-primary);
            overflow: auto;
        }

        .lambert-panel-header {
            padding: 10px 12px;
            background: var(--bg-secondary);
            border-bottom: 1px solid var(--border-color);
        }

        .lambert-panel-title {
            font-size: 13px;
            font-weight: 600;
            color: var(--accent-orange);
        }

        .lambert-panel-content {
            padding: 12px;
            display: flex;
            flex-direction: column;
            gap: 16px;
        }

        .lambert-section {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .lambert-field {
            display: flex;
            flex-direction: column;
            gap: 4px;
        }

        .lambert-field label {
            font-size: 11px;
            color: var(--text-muted);
            font-weight: 500;
        }

        .lambert-select {
            padding: 6px 8px;
            font-size: 11px;
            background: var(--bg-tertiary);
            border: 1px solid var(--border-color);
            border-radius: 3px;
            color: var(--text-primary);
            cursor: pointer;
        }

        .lambert-select:focus {
            outline: none;
            border-color: var(--accent-orange);
        }

        .lambert-select option {
            background: var(--bg-secondary);
            color: var(--text-primary);
        }

        .lambert-tof-row {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .lambert-slider {
            flex: 1;
            height: 4px;
            -webkit-appearance: none;
            appearance: none;
            background: var(--bg-tertiary);
            border-radius: 2px;
            outline: none;
        }

        .lambert-slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 14px;
            height: 14px;
            border-radius: 50%;
            background: var(--accent-orange);
            cursor: pointer;
        }

        .lambert-slider::-moz-range-thumb {
            width: 14px;
            height: 14px;
            border-radius: 50%;
            background: var(--accent-orange);
            cursor: pointer;
            border: none;
        }

        .lambert-input {
            width: 70px;
            padding: 4px 6px;
            font-size: 11px;
            background: var(--bg-tertiary);
            border: 1px solid var(--border-color);
            border-radius: 3px;
            color: var(--text-primary);
            text-align: right;
        }

        .lambert-input:focus {
            outline: none;
            border-color: var(--accent-orange);
        }

        .lambert-unit {
            font-size: 10px;
            color: var(--text-muted);
            min-width: 12px;
        }

        .lambert-tof-display {
            font-size: 10px;
            color: var(--text-secondary);
            text-align: center;
            margin-top: 2px;
        }

        .lambert-rev-buttons {
            display: flex;
            gap: 4px;
        }

        .lambert-rev-btn {
            flex: 1;
            padding: 6px 8px;
            font-size: 11px;
            font-weight: 500;
            background: var(--bg-tertiary);
            border: 1px solid var(--border-color);
            border-radius: 3px;
            color: var(--text-secondary);
            cursor: pointer;
            transition: all 0.15s ease;
        }

        .lambert-rev-btn:hover {
            background: var(--bg-secondary);
            color: var(--text-primary);
        }

        .lambert-rev-btn.active {
            background: var(--accent-orange);
            border-color: var(--accent-orange);
            color: var(--bg-primary);
        }

        .lambert-compute-btn {
            width: 100%;
            padding: 10px 16px;
            font-size: 12px;
            font-weight: 600;
            background: var(--accent-orange);
            border: none;
            border-radius: 4px;
            color: var(--bg-primary);
            cursor: pointer;
            transition: all 0.15s ease;
        }

        .lambert-compute-btn:hover:not(:disabled) {
            background: #e69500;
            transform: translateY(-1px);
        }

        .lambert-compute-btn:disabled {
            background: var(--bg-tertiary);
            color: var(--text-muted);
            cursor: not-allowed;
        }

        .lambert-results {
            background: var(--bg-secondary);
            border-radius: 4px;
            padding: 12px;
            border: 1px solid var(--border-color);
        }

        .lambert-results-header {
            font-size: 11px;
            font-weight: 600;
            color: var(--accent-orange);
            margin-bottom: 10px;
            padding-bottom: 6px;
            border-bottom: 1px solid var(--border-color);
        }

        .lambert-result-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 4px 0;
            font-size: 11px;
        }

        .lambert-result-label {
            color: var(--text-muted);
        }

        .lambert-result-value {
            color: var(--text-primary);
            font-family: 'Courier New', Consolas, monospace;
        }

        .lambert-result-total {
            margin-top: 6px;
            padding-top: 8px;
            border-top: 1px solid var(--border-color);
            font-weight: 600;
        }

        .lambert-result-total .lambert-result-label {
            color: var(--text-primary);
        }

        .lambert-result-total .lambert-result-value {
            color: var(--accent-orange);
            font-size: 12px;
        }

        .lambert-status {
            font-size: 10px;
            padding: 6px 8px;
            border-radius: 3px;
            text-align: center;
        }

        .lambert-status.error {
            background: rgba(255, 80, 80, 0.15);
            color: #ff5050;
            border: 1px solid rgba(255, 80, 80, 0.3);
        }

        .lambert-status.success {
            background: rgba(80, 200, 80, 0.15);
            color: #50c850;
            border: 1px solid rgba(80, 200, 80, 0.3);
        }

        .lambert-status.info {
            background: rgba(100, 150, 255, 0.15);
            color: #6496ff;
            border: 1px solid rgba(100, 150, 255, 0.3);
        }

        /* Light theme overrides */
        .theme-light .lambert-compute-btn:disabled {
            background: #e0e0e0;
            color: #888;
        }

        .theme-light .lambert-result-total .lambert-result-value {
            color: #c87800;
        }

        /* ============================================
           LOG PANEL (Bottom 20% of pane-bottom-left)
           ============================================ */

        #pane-bottom-left {
            display: flex;
            flex-direction: column;
        }

        .pane-content-area {
            flex: 1 1 auto;
            overflow: auto;
        }

        .pane-log-area {
            flex: 0 0 100px;
            display: flex;
            flex-direction: column;
            background: var(--bg-primary);
            position: relative;
            border-top: 1px solid var(--border-color);
            overflow: hidden;
        }

        /* Log inline controls (positioned in top-left of log display) */
        .log-inline-controls {
            position: absolute;
            top: 4px;
            left: 4px;
            display: flex;
            gap: 4px;
            align-items: center;
            z-index: 10;
            background: rgba(10, 10, 10, 0.85);
            padding: 2px 4px;
            border-radius: 2px;
        }

        .log-text {
            font-size: 7px;
            color: var(--text-secondary);
            font-family: 'Courier New', Consolas, monospace;
            user-select: none;
            min-width: 15px;
            text-align: right;
        }

        .log-btn {
            padding: 2px 6px;
            font-size: 8px;
            font-weight: 600;
            border: 1px solid var(--border-color);
            border-radius: 2px;
            background: var(--bg-tertiary);
            color: var(--text-primary);
            cursor: pointer;
            transition: none;
        }

        .log-btn:hover {
            background: var(--bg-primary);
            border-color: var(--accent-blue-grey);
        }

        .log-btn:active {
            transform: scale(0.95);
        }

        .log-btn.stub {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .log-display {
            flex: 1;
            overflow-y: auto;
            overflow-x: hidden;
            padding: 4px;
            padding-top: 24px;
            padding-left: 4px;
            font-family: 'Courier New', Consolas, monospace;
            font-size: 8px;
            line-height: 1.3;
            color: var(--text-secondary);
            user-select: text;
            -webkit-user-select: text;
            -moz-user-select: text;
            -ms-user-select: text;
        }

        .log-entry {
            padding: 2px 0;
            border-bottom: 1px solid #1a1a1a;
            word-wrap: break-word;
            color: var(--text-secondary);
        }

        /* Log panel resize handle (top border) */
        .log-resize-handle {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 12px;
            cursor: ns-resize;
            z-index: 1002;
        }

        /* Gradient line shown on hover (keeps hitbox stable) */
        .log-resize-handle::before {
            content: '';
            position: absolute;
            left: 0;
            top: 5px;
            width: 100%;
            height: 2px;
            opacity: 0;
            transition: opacity 0.15s;
            background: linear-gradient(90deg,
                rgba(157, 212, 255, 0.8) 0%,
                rgba(180, 220, 255, 0.9) 25%,
                rgba(200, 200, 255, 0.9) 50%,
                rgba(180, 220, 255, 0.9) 75%,
                rgba(157, 212, 255, 0.8) 100%);
        }

        .log-resize-handle:hover::before,
        .log-resize-handle.active::before {
            opacity: 1;
        }

        /* Log context menu */
        .log-context-menu {
            position: fixed;
            display: none;
            background: var(--bg-secondary);
            border: 1px solid var(--accent-blue-grey);
            border-radius: 2px;
            z-index: 10000;
            min-width: 100px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.5);
        }

        .log-context-menu.visible {
            display: block;
        }

        .log-context-item {
            padding: 6px 12px;
            cursor: pointer;
            font-size: 10px;
            color: var(--text-primary);
            border-bottom: 1px solid var(--border-color);
            transition: background 0.15s;
        }

        .log-context-item:last-child {
            border-bottom: none;
        }

        .log-context-item:hover {
            background: var(--bg-tertiary);
            color: var(--accent-blue-grey);
        }

        /* Grid border resize handles (invisible hitboxes) */
        .grid-resize-handle {
            position: absolute;
            z-index: 1001;
        }

        /* Vertical border handle (between left and right panes) */
        .grid-resize-vertical {
            width: 12px;
            height: 100%;
            top: 0;
            cursor: ew-resize;
        }

        /* Horizontal border handle (between top and bottom panes) */
        .grid-resize-horizontal {
            width: 100%;
            height: 12px;
            left: 0;
            cursor: ns-resize;
        }

        /* Gradient lines shown on hover (keep hitboxes stable) */
        .grid-resize-vertical::before {
            content: '';
            position: absolute;
            left: 5px;
            top: 0;
            width: 2px;
            height: 100%;
            opacity: 0;
            transition: opacity 0.15s;
            background: linear-gradient(180deg,
                rgba(157, 212, 255, 0.8) 0%,
                rgba(180, 220, 255, 0.9) 25%,
                rgba(200, 200, 255, 0.9) 50%,
                rgba(180, 220, 255, 0.9) 75%,
                rgba(157, 212, 255, 0.8) 100%);
        }

        .grid-resize-vertical:hover::before,
        .grid-resize-vertical.active::before {
            opacity: 1;
        }

        .grid-resize-horizontal::before {
            content: '';
            position: absolute;
            left: 0;
            top: 5px;
            width: 100%;
            height: 2px;
            opacity: 0;
            transition: opacity 0.15s;
            background: linear-gradient(90deg,
                rgba(157, 212, 255, 0.8) 0%,
                rgba(180, 220, 255, 0.9) 25%,
                rgba(200, 200, 255, 0.9) 50%,
                rgba(180, 220, 255, 0.9) 75%,
                rgba(157, 212, 255, 0.8) 100%);
        }

        .grid-resize-horizontal:hover::before,
        .grid-resize-horizontal.active::before {
            opacity: 1;
        }

        /* Crosshair handle (resizes all 4 panes simultaneously) */
        .grid-resize-crosshair {
            position: absolute;
            width: 20px;
            height: 20px;
            cursor: move;
            z-index: 1002;
            opacity: 0;
            transition: opacity 0.15s;
            pointer-events: none;
            --glow-intensity: 0;
        }

        .grid-resize-crosshair.visible {
            opacity: 1;
            pointer-events: auto;
        }

        .grid-resize-crosshair svg {
            filter: drop-shadow(0 0 calc(var(--glow-intensity) * 8px) rgba(157, 212, 255, var(--glow-intensity)));
            transition: filter 0.05s linear;
            pointer-events: none; /* SVG doesn't intercept events */
            display: block; /* Remove inline spacing */
        }

        .grid-resize-crosshair.active svg {
            filter: drop-shadow(0 0 12px rgba(157, 212, 255, 0.9));
        }

        /* ============================================
           MOBILE RESPONSIVE
           ============================================ */

        @media (max-width: 768px) {
            :root {
                --panel-expanded-width: var(--mobile-panel-width);
            }

            /* On mobile, panel starts collapsed */
            #control-panel {
                width: var(--panel-collapsed-width);
            }

            /* Overlay mode on mobile when expanded */
            #control-panel.expanded {
                box-shadow: 2px 0 12px rgba(0, 0, 0, 0.5);
            }

            /* Map doesn't shift on mobile, panel overlays */
            #map-container {
                left: 0;
                width: 100vw;
            }

            #control-panel.expanded ~ #map-container {
                left: 0;
                width: 100vw;
            }
        }

        @media (max-width: 480px) {
            :root {
                --mobile-panel-width: 200px;
            }

            .panel-title {
                font-size: 12px;
            }

            .nav-label {
                font-size: 13px;
            }

            .content-section {
                padding: 16px;
            }
        }

        /* ============================================
           SCROLLBAR STYLING
           ============================================ */

        ::-webkit-scrollbar {
            width: 6px;
        }

        ::-webkit-scrollbar-track {
            background: var(--bg-secondary);
        }

        ::-webkit-scrollbar-thumb {
            background: var(--bg-tertiary);
            border-radius: 3px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: var(--border-color);
        }

        /* ============================================
           SENSOR CONTROLS
           ============================================ */

        .sensor-controls {
            display: flex;
            flex-direction: column;
            gap: 6px;
        }

        /* Sensor table wrapper */
        .sensor-table-wrapper {
            min-height: 280px;
            max-height: 400px;
            overflow-y: auto;
            overflow-x: hidden;
            border: 1px solid var(--border-color);
            border-radius: 3px;
        }

        /* Sensor table */
        .sensor-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 8px;
            font-family: var(--font-mono);
        }

        .sensor-table thead {
            position: sticky;
            top: 0;
            background: var(--bg-secondary);
            z-index: 10;
        }

        .sensor-table th {
            padding: 4px 2px;
            text-align: center;
            font-weight: 600;
            color: var(--text-primary);
            border-bottom: 1px solid var(--border-color);
            font-size: 7px;
            text-transform: uppercase;
            letter-spacing: 0.3px;
            cursor: pointer;
            user-select: none;
            transition: background 0.15s;
        }

        .sensor-table th:hover {
            background: var(--bg-tertiary);
            color: var(--accent-blue-grey);
        }

        .sensor-table td {
            padding: 3px 2px;
            border-bottom: 1px solid #2a2a2a;
            color: var(--text-primary);
            text-align: center;
        }

        .sensor-table tbody tr:hover {
            background: var(--bg-tertiary);
        }

        .sensor-table tbody tr.selected {
            background: #1a2a3a;
        }

        /* Column widths (total ~195px to fit in 224px - 28px padding) */
        .col-sel { width: 18px; }
        .col-name { width: 60px; text-align: left !important; padding-left: 4px; }
        .col-lat { width: 37px; }
        .col-lon { width: 40px; }
        .col-alt { width: 35px; }

        /* Satellite table specific column widths */
        #satellite-table th.col-norad { width: 45px; }
        #satellite-table th.col-name { width: 55px; }
        #satellite-table th.col-star { width: 24px; text-align: center; }
        #satellite-table th.col-list { width: 40px; text-align: center; }
        /* Apply to td via nth-child since JS doesn't add classes to cells */
        #satellite-table td:nth-child(2) { width: 45px; } /* NORAD */
        #satellite-table td:nth-child(3) { width: 55px; max-width: 55px; overflow: hidden; text-overflow: ellipsis; } /* Name */
        #satellite-table td:nth-child(4) { width: 24px; } /* Star */
        #satellite-table td:nth-child(5) { width: 40px; max-width: 40px; overflow: hidden; } /* List */
        #satellite-table td:nth-child(5) select { max-width: 36px; font-size: 8px; }

        /* Checkbox styling */
        .sensor-checkbox {
            width: 12px;
            height: 12px;
            cursor: pointer;
            margin: 0;
            accent-color: var(--accent-blue-grey);
        }

        /* Sensor action buttons */
        .sensor-actions {
            display: flex;
            gap: 4px;
            margin-top: 2px;
        }

        .sensor-action-btn {
            flex: 1;
            height: 22px;
            border: 1px solid var(--border-color);
            border-radius: 3px;
            font-size: 9px;
            font-weight: 600;
            cursor: pointer;
            transition: none;
            background: var(--bg-tertiary);
            color: var(--text-primary);
        }

        .sensor-action-btn:hover {
            background: var(--bg-primary);
            border-color: var(--accent-blue-grey);
        }

        .sensor-action-btn:active {
            transform: scale(0.95);
        }

        .sensor-add-btn {
            background: var(--bg-tertiary);
            color: var(--text-primary);
        }

        .sensor-edit-btn {
            background: var(--bg-tertiary);
            color: var(--text-primary);
        }

        .sensor-delete-btn {
            background: var(--bg-tertiary);
            color: var(--text-primary);
        }

        /* Clickable rows */
        .sensor-table tbody tr {
            cursor: pointer;
            user-select: none;
        }

        /* Satellite table - match sensor table row height and checkbox size */
        #satellite-table td {
            padding: 3px 2px;
        }

        #satellite-table .col-name {
            text-align: left !important;
            padding-left: 4px;
        }

        /* Ensure all checkboxes are same size */
        .sensor-table input[type="checkbox"] {
            width: 12px;
            height: 12px;
            margin: 0;
        }

        /* ============================================
           MODAL OVERLAY (Confirmation + Editor)
           ============================================ */

        .modal-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            background: rgba(0, 0, 0, 0.75);
            z-index: 2000;
            align-items: center;
            justify-content: center;
        }

        .modal-overlay.visible {
            display: flex;
        }

        /* Confirmation Modal */
        .modal-confirm {
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: 4px;
            padding: 16px;
            min-width: 280px;
            max-width: 400px;
        }

        .modal-confirm-title {
            font-size: 11px;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 8px;
        }

        .modal-confirm-message {
            font-size: 9px;
            color: var(--text-secondary);
            margin-bottom: 12px;
            line-height: 1.4;
        }

        .modal-confirm-sensors {
            font-size: 9px;
            color: var(--accent-blue-grey);
            margin-bottom: 16px;
            padding: 6px;
            background: var(--bg-primary);
            border: 1px solid var(--border-color);
            border-radius: 3px;
        }

        .modal-confirm-buttons {
            display: flex;
            gap: 8px;
        }

        .modal-confirm-btn {
            flex: 1;
            height: 28px;
            border: 1px solid var(--border-color);
            border-radius: 3px;
            font-size: 10px;
            font-weight: 600;
            cursor: pointer;
            transition: none;
        }

        .modal-confirm-btn-cancel {
            background: var(--bg-tertiary);
            color: var(--text-primary);
        }

        .modal-confirm-btn-cancel:hover {
            background: var(--bg-primary);
            border-color: var(--text-secondary);
        }

        .modal-confirm-btn-delete {
            background: #aa3333;
            color: var(--text-primary);
            border-color: #aa3333;
        }

        .modal-confirm-btn-delete:hover {
            background: #cc4444;
        }

        /* Editor Modal */
        .modal-editor {
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: 4px;
            padding: 16px;
            width: 300px;
        }

        .modal-editor-title {
            font-size: 11px;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 12px;
        }

        .modal-editor-form {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .modal-editor-field {
            display: flex;
            flex-direction: column;
            gap: 3px;
        }

        .modal-editor-label {
            font-size: 8px;
            font-weight: 600;
            color: var(--text-secondary);
            text-transform: uppercase;
            letter-spacing: 0.3px;
        }

        .modal-editor-input {
            height: 24px;
            background: var(--bg-primary);
            border: 1px solid var(--border-color);
            border-radius: 3px;
            color: var(--text-primary);
            font-size: 10px;
            font-family: var(--font-mono);
            padding: 0 6px;
        }

        .modal-editor-input:focus {
            outline: none;
            border-color: var(--accent-blue-grey);
        }

        .modal-editor-textarea {
            min-height: 60px;
            background: var(--bg-primary);
            border: 1px solid var(--border-color);
            border-radius: 3px;
            color: var(--text-primary);
            font-size: 10px;
            font-family: var(--font-mono);
            padding: 6px;
            resize: vertical;
        }

        /* Satellite modal needs wider width for TLE (69 chars per line) */
        #satellite-editor-modal-overlay .modal-editor {
            width: 480px;
        }

        #satellite-editor-input-tle {
            white-space: pre;
            overflow-x: auto;
        }

        .modal-editor-textarea:focus {
            outline: none;
            border-color: var(--accent-blue-grey);
        }

        .modal-editor-buttons {
            display: flex;
            gap: 8px;
            margin-top: 8px;
        }

        .modal-editor-btn {
            flex: 1;
            height: 28px;
            border: 1px solid var(--border-color);
            border-radius: 3px;
            font-size: 10px;
            font-weight: 600;
            cursor: pointer;
            transition: none;
        }

        .modal-editor-btn-cancel {
            background: var(--bg-tertiary);
            color: var(--text-primary);
        }

        .modal-editor-btn-cancel:hover {
            background: var(--bg-primary);
            border-color: var(--text-secondary);
        }

        .modal-editor-btn-save {
            background: var(--accent-blue-grey);
            color: var(--bg-primary);
        }

        .modal-editor-btn-save:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(157, 212, 255, 0.3);
        }

        /* Modal Color Picker */
        .modal-color-picker {
            display: flex;
            gap: 8px;
            padding: 4px 0;
        }

        .modal-color-btn {
            width: 24px;
            height: 24px;
            border-radius: 3px;
            cursor: pointer;
            transition: transform 0.1s;
        }

        .modal-color-btn:hover {
            transform: scale(1.1);
        }

        .modal-color-btn.active {
            box-shadow: 0 0 0 2px var(--bg-primary), 0 0 0 4px var(--accent-blue-grey);
        }

        /* Modal Select */
        .modal-editor-select {
            width: 100%;
            height: 28px;
            padding: 0 8px;
            font-size: 11px;
            font-family: inherit;
            border: 1px solid var(--border-color);
            border-radius: 3px;
            background: var(--bg-secondary);
            color: var(--text-primary);
            cursor: pointer;
        }

        .modal-editor-select:focus {
            outline: none;
            border-color: var(--accent-blue-grey);
        }

        /* Modal Satellite Picker (virtual scrolling) */
        .modal-satellite-picker {
            overflow-y: auto;
            border: 1px solid var(--border-color);
            border-radius: 3px;
            background: var(--bg-secondary);
            /* flex: 1 and min-height: 0 set inline for virtual scrolling */
        }

        /* List Editor Loading Indicator */
        .list-editor-loading {
            position: absolute;
            top: 0; left: 0; right: 0; bottom: 0;
            background: rgba(0, 0, 0, 0.7);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 10;
            border-radius: 3px;
        }
        .list-editor-loading-content {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 8px;
            color: var(--text-primary);
            font-size: 11px;
        }
        .list-editor-spinner {
            width: 24px; height: 24px;
            border: 2px solid var(--border-color);
            border-top-color: var(--accent-blue-grey);
            border-radius: 50%;
            animation: list-editor-spin 0.8s linear infinite;
        }
        @keyframes list-editor-spin { to { transform: rotate(360deg); } }

        .modal-satellite-item {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 6px 8px;
            border-bottom: 1px solid var(--border-color);
            font-size: 11px;
            cursor: pointer;
        }

        .modal-satellite-item:last-child {
            border-bottom: none;
        }

        .modal-satellite-item:hover {
            background: var(--bg-tertiary);
        }

        .modal-satellite-item input[type="checkbox"] {
            cursor: pointer;
        }

        .modal-satellite-item .sat-name {
            flex: 1;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .modal-satellite-item .sat-norad {
            color: var(--text-muted);
            font-size: 10px;
        }
        /* Catalog Edit Modal (Two-Panel) */
        .modal-catalog-edit {
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: 4px;
            width: 700px;
            max-width: 95vw;
            max-height: 85vh;
            display: flex;
            flex-direction: column;
        }

        .modal-catalog-edit-header {
            display: flex;
            align-items: center;
            padding: 12px 16px;
            border-bottom: 1px solid var(--border-color);
            gap: 12px;
        }

        .modal-catalog-edit-title-input {
            flex: 1;
            background: var(--bg-tertiary);
            border: 1px solid var(--border-color);
            border-radius: 3px;
            padding: 6px 10px;
            color: var(--text-primary);
            font-size: 12px;
            font-weight: 600;
        }

        .modal-catalog-edit-close {
            background: none;
            border: none;
            color: var(--text-muted);
            font-size: 20px;
            cursor: pointer;
            padding: 0 4px;
        }

        .modal-catalog-edit-close:hover {
            color: var(--text-primary);
        }

        .modal-catalog-edit-body {
            display: flex;
            flex: 1;
            min-height: 0;
        }

        .modal-catalog-edit-left {
            width: 45%;
            display: flex;
            flex-direction: column;
            border-right: 1px solid var(--border-color);
        }

        .modal-catalog-edit-right {
            width: 55%;
            display: flex;
            flex-direction: column;
            padding: 12px;
            overflow-y: auto;
        }

        .modal-catalog-edit-table-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px 12px;
            background: var(--bg-tertiary);
            border-bottom: 1px solid var(--border-color);
            font-size: 11px;
            font-weight: 600;
        }

        .modal-catalog-edit-add-btn {
            background: var(--accent-blue-grey);
            border: none;
            border-radius: 3px;
            padding: 3px 8px;
            color: white;
            font-size: 10px;
            cursor: pointer;
        }

        .modal-catalog-edit-table-container {
            flex: 1;
            min-height: 0;  /* Required for flex children with overflow */
            overflow-y: auto;
        }

        .modal-catalog-edit-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 10px;
        }

        .modal-catalog-edit-table th {
            background: var(--bg-tertiary);
            padding: 6px 8px;
            text-align: left;
            font-weight: 600;
            border-bottom: 1px solid var(--border-color);
            position: sticky;
            top: 0;
        }

        /* Modal table header columns (sortable) */
        .modal-header-col.sortable:hover {
            color: var(--text-primary);
        }

        .modal-header-col.sorted {
            color: var(--text-primary);
            font-weight: 600;
        }

        .modal-catalog-edit-table td {
            padding: 5px 8px;
            border-bottom: 1px solid var(--border-color);
        }

        .modal-catalog-edit-table tbody tr {
            cursor: pointer;
        }

        .modal-catalog-edit-table tbody tr:hover {
            background: var(--bg-tertiary);
        }

        .modal-catalog-edit-table tbody tr.selected {
            background: var(--accent-blue-grey);
            color: white;
        }

        /* Virtual Scrolling Rows */
        .virtual-row {
            background: var(--bg-secondary);
            transition: background 0.1s;
        }

        .virtual-row:hover {
            background: var(--bg-tertiary);
        }

        .virtual-row.selected {
            background: var(--accent-blue-grey);
            color: white;
        }

        .modal-catalog-edit-help {
            padding: 6px 12px;
            font-size: 9px;
            color: var(--text-muted);
            text-align: center;
            border-top: 1px solid var(--border-color);
        }

        .modal-catalog-edit-detail-placeholder {
            display: flex;
            align-items: center;
            justify-content: center;
            height: 100%;
            color: var(--text-muted);
            font-size: 11px;
        }

        .modal-catalog-edit-detail-form {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .modal-catalog-edit-lists {
            max-height: 100px;
            overflow-y: auto;
            border: 1px solid var(--border-color);
            border-radius: 3px;
            background: var(--bg-tertiary);
        }

        .modal-catalog-edit-list-item {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 5px 8px;
            font-size: 10px;
            border-bottom: 1px solid var(--border-color);
        }

        .modal-catalog-edit-list-item:last-child {
            border-bottom: none;
        }

        .modal-catalog-edit-detail-buttons {
            display: flex;
            gap: 8px;
            margin-top: 8px;
        }

        .modal-catalog-edit-footer {
            padding: 10px 16px;
            border-top: 1px solid var(--border-color);
            display: flex;
            justify-content: flex-end;
        }

        .modal-catalog-edit-color-cell {
            width: 16px;
            height: 16px;
            border-radius: 50%;
            border: 2px solid var(--border-color);
        }

        .modal-catalog-edit-color-cell.grey {
            background: var(--text-muted);
        }

        .modal-catalog-edit-color-cell.red {
            background: var(--accent-red);
        }

        .modal-catalog-edit-color-cell.blue {
            background: var(--accent-blue-grey);
        }




    </style>
</head>
<body>
    <!-- Control Panel -->
    <div id="control-panel">
        <!-- Header with collapse button -->
        <div class="panel-header">
            <button class="collapse-btn" id="collapse-btn" title="Collapse panel">
                <!-- Collapse icon: panel with left arrow -->
                <svg class="collapse-icon-expanded" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
                    <line x1="9" y1="3" x2="9" y2="21"></line>
                    <polyline points="15 9 12 12 15 15"></polyline>
                </svg>
                <!-- Expand icon: panel with right arrow -->
                <svg class="collapse-icon-collapsed" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
                    <line x1="9" y1="3" x2="9" y2="21"></line>
                    <polyline points="12 9 15 12 12 15"></polyline>
                </svg>
            </button>
            <span class="panel-title">Control Panel</span>
        </div>

        <!-- Navigation Buttons (upper 1/3) -->
        <div class="nav-section">
            <button class="nav-btn" data-section="time">
                <span class="nav-icon">
                    <!-- Clock icon -->
                    <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <circle cx="12" cy="12" r="10"></circle>
                        <polyline points="12 6 12 12 16 14"></polyline>
                    </svg>
                </span>
                <span class="nav-label">Time</span>
            </button>
            <button class="nav-btn" data-section="catalogs">
                <span class="nav-icon">
                    <!-- Satellite icon from satellite.svg -->
                    <img src="/static/satellite.svg" width="14" height="14" style="filter: invert(1);">
                </span>
                <span class="nav-label">Catalogs</span>
            </button>
            <button class="nav-btn" data-section="watchlist">
                <span class="nav-icon">
                    <!-- Star icon -->
                    <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"></polygon>
                    </svg>
                </span>
                <span class="nav-label">Watch Lists</span>
            </button>
            <button class="nav-btn" data-section="sensors">
                <span class="nav-icon">
                    <!-- Sensor icon from sensor.svg -->
                    <img src="/static/sensor.svg" width="14" height="14" style="filter: invert(1);">
                </span>
                <span class="nav-label">Sensors</span>
            </button>
            <button class="nav-btn" data-section="realtime">
                <span class="nav-icon">
                    <!-- Activity/pulse icon -->
                    <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <polyline points="22 12 18 12 15 21 9 3 6 12 2 12"></polyline>
                    </svg>
                </span>
                <span class="nav-label">Real Time Data</span>
            </button>
            <button class="nav-btn" data-section="analysis">
                <span class="nav-icon">
                    <!-- Bar chart icon -->
                    <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <line x1="12" y1="20" x2="12" y2="10"></line>
                        <line x1="18" y1="20" x2="18" y2="4"></line>
                        <line x1="6" y1="20" x2="6" y2="16"></line>
                    </svg>
                </span>
                <span class="nav-label">Analysis</span>
            </button>
            <!-- Separator between Analysis and Tests/Settings -->
            <hr class="nav-separator" style="border: none; border-top: 1px solid var(--border-color); margin: 8px 0; width: 100%;">
            <button class="nav-btn" data-section="tests">
                <span class="nav-icon">
                    <!-- Checkmark/test icon -->
                    <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <polyline points="9 11 12 14 22 4"></polyline>
                        <path d="M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11"></path>
                    </svg>
                </span>
                <span class="nav-label">Tests</span>
            </button>
            <button class="nav-btn" data-section="settings">
                <span class="nav-icon">
                    <!-- Settings/gear icon -->
                    <svg width="14" height="14" viewBox="0 0 472.615 472.615" fill="currentColor">
                        <path d="M472.615,274.117V198.4l-55.335-9.255c-4.332-16.64-10.929-32.492-19.692-47.458L430.178,96l-53.563-53.563 l-45.686,32.591c-14.966-8.763-30.917-15.36-47.557-19.692L274.215,0H198.4l-9.157,55.335 c-16.64,4.332-32.591,10.929-47.557,19.692L96,42.437L42.437,96l32.591,45.686c-8.763,14.966-15.36,30.818-19.692,47.458L0,198.4 v75.717l55.335,9.255c4.332,16.64,10.929,32.591,19.692,47.557l-32.591,45.686L96,430.178l45.686-32.689 c14.966,8.862,30.917,15.458,47.557,19.791l9.157,55.335h75.815l9.157-55.335c16.64-4.332,32.591-10.929,47.557-19.791 l45.686,32.689l53.563-53.563l-32.591-45.686c8.763-14.966,15.36-30.917,19.692-47.557L472.615,274.117z M236.308,334.769 c-54.252,0-98.462-44.209-98.462-98.462c0-54.351,44.209-98.462,98.462-98.462s98.462,44.111,98.462,98.462 C334.769,290.56,290.56,334.769,236.308,334.769z"/>
                    </svg>
                </span>
                <span class="nav-label">Settings</span>
            </button>
        </div>

        <!-- Content Area (lower 2/3) -->
        <div class="content-section">
            <!-- Time Controls (default active) -->
            <div id="content-time" class="time-controls">
                <div class="time-control-group">
                    <label class="time-label">Start</label>
                    <div class="time-input-row">
                        <button class="time-arrow-btn" data-target="start" data-delta="-1"><</button>
                        <input type="datetime-local" class="time-input" id="start-time" />
                        <button class="time-arrow-btn" data-target="start" data-delta="1">></button>
                        <button class="time-now-btn" data-target="start">Now</button>
                    </div>
                </div>

                <div class="time-control-group">
                    <label class="time-label">Stop</label>
                    <div class="time-input-row">
                        <button class="time-arrow-btn" data-target="stop" data-delta="-1"><</button>
                        <input type="datetime-local" class="time-input" id="stop-time" />
                        <button class="time-arrow-btn" data-target="stop" data-delta="1">></button>
                        <button class="time-now-btn" data-target="stop">Now</button>
                    </div>
                </div>

                <!-- Cancel/Apply buttons (shown when changes are pending) -->
                <div class="time-actions" id="time-actions">
                    <button class="time-action-btn time-cancel-btn" id="time-cancel-btn">Cancel</button>
                    <button class="time-action-btn time-apply-btn" id="time-apply-btn">Apply</button>
                </div>

                <!-- Simulation Time controls moved to Map Time Bar -->

            </div>

            <!-- Other sections (hidden by default) -->
            <div id="content-catalogs" style="display: none;">
                <!-- Catalog table -->
                <div class="sensor-controls">
                    <div class="sensor-table-wrapper">
                        <table class="sensor-table" id="catalog-table">
                            <thead>
                                <tr>
                                    <th class="col-sel" style="width: 24px;"></th>
                                    <th class="col-name">Cat Name</th>
                                    <th class="col-count" style="width: 40px;">Sats</th>
                                </tr>
                            </thead>
                            <tbody>
                                <!-- Populated by JavaScript -->
                            </tbody>
                        </table>
                    </div>

                    <!-- Action buttons -->
                    <div class="sensor-actions">
                        <button class="sensor-action-btn sensor-add-btn" id="catalog-add-btn">+Cat</button>
                        <button class="sensor-action-btn sensor-delete-btn" id="catalog-delete-btn">Delete</button>
                    </div>
                    <p style="color: var(--text-muted); font-size: 9px; margin-top: 8px;">
                        Catalogs contain satellite TLE data
                    </p>
                </div>
            </div>

            <div id="content-sensors" style="display: none;">
                <!-- Sensor table -->
                <div class="sensor-controls">
                    <div class="sensor-table-wrapper">
                        <table class="sensor-table" id="sensor-table">
                            <thead>
                                <tr>
                                    <th class="col-sel">Sel</th>
                                    <th class="col-name">Name</th>
                                    <th class="col-lat">Lat</th>
                                    <th class="col-lon">Lon</th>
                                    <th class="col-alt">Alt</th>
                                </tr>
                            </thead>
                            <tbody id="sensor-table-body">
                                <!-- Populated by JavaScript -->
                            </tbody>
                        </table>
                    </div>

                    <!-- CRUD buttons -->
                    <div class="sensor-actions">
                        <button class="sensor-action-btn sensor-add-btn" id="sensor-add-btn">Add</button>
                        <button class="sensor-action-btn sensor-edit-btn" id="sensor-edit-btn">Edit</button>
                        <button class="sensor-action-btn sensor-delete-btn" id="sensor-delete-btn">Delete</button>
                    </div>
                </div>
            </div>

            <div id="content-analysis" style="display: none;">
                <!-- Analysis Tools Checkboxes -->
                <div class="analysis-controls">
                    <table class="analysis-table">
                        <thead>
                            <tr>
                                <th class="col-check" style="width: 30px;"></th>
                                <th class="col-name">Analysis Tool</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr data-tool="polar-plot">
                                <td class="col-check">
                                    <input type="checkbox" id="analysis-polar-plot" class="analysis-checkbox">
                                </td>
                                <td class="col-name">
                                    <label for="analysis-polar-plot">Polar Plot</label>
                                </td>
                            </tr>
                            <tr data-tool="lambert">
                                <td class="col-check">
                                    <input type="checkbox" id="analysis-lambert" class="analysis-checkbox">
                                </td>
                                <td class="col-name">
                                    <label for="analysis-lambert">Lambert Transfer</label>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                    <p class="helper-text" style="margin-top: 8px; font-size: 10px; color: var(--text-muted);">
                        Check to enable tool, then click a sensor on the map
                    </p>
                </div>
            </div>

            <div id="content-realtime" style="display: none;">
                <p style="color: var(--text-muted);">Real-time data coming soon...</p>
            </div>

            <div id="content-logs" style="display: none;">
                <p style="color: var(--text-muted);">Logs coming soon...</p>
            </div>

            <div id="content-tests" style="display: none;">
                <p style="color: var(--text-muted);">Test panel coming soon...</p>
                <p style="color: var(--text-secondary); font-size: 10px; margin-top: 8px;">
                    Use the test page at <a href="/static/test-basic.html" target="_blank" style="color: var(--accent-blue-grey);">/static/test-basic.html</a>
                </p>
            </div>

            <div id="content-watchlist" style="display: none;">
                <!-- Watch Lists table -->
                <div class="sensor-controls">
                    <div class="sensor-table-wrapper">
                        <table class="sensor-table" id="watchlist-table">
                            <thead>
                                <tr>
                                    <th class="col-sel" style="width: 24px;"></th>
                                    <th class="col-name">List Name</th>
                                    <th class="col-count" style="width: 40px;">Sats</th>
                                </tr>
                            </thead>
                            <tbody>
                                <!-- Populated by JavaScript -->
                            </tbody>
                        </table>
                    </div>
                    <!-- Action buttons -->
                    <div class="sensor-actions" style="margin-top: 8px;">
                        <button class="sensor-action-btn sensor-add-btn" id="watchlist-add-list-btn">+List</button>
                        <button class="sensor-action-btn sensor-delete-btn" id="watchlist-delete-btn">Delete</button>
                    </div>
                    <p style="color: var(--text-muted); font-size: 9px; margin-top: 8px;">
                        Double-click list to edit
                    </p>
                </div>
            </div>



            <div id="content-settings" style="display: none;">
                <!-- Profile Section -->
                <div class="settings-section" style="margin-bottom: 16px; padding-bottom: 12px; border-bottom: 1px solid var(--border-color);">
                    <label class="time-label">Profile</label>
                    <div style="display: flex; align-items: center; gap: 10px; margin-top: 8px;">
                        <span id="profile-display-name" style="color: var(--text-secondary); font-size: 12px;">Not logged in</span>
                        <button id="profile-login-btn" class="sensor-action-btn" style="padding: 4px 12px; font-size: 11px;">Login</button>
                        <button id="profile-logout-btn" class="sensor-action-btn sensor-delete-btn" style="padding: 4px 12px; font-size: 11px; display: none;">Logout</button>
                        <button id="profile-defaults-btn" class="sensor-action-btn" style="padding: 4px 12px; font-size: 11px;">Defaults</button>
                    </div>
                </div>

                <!-- Appearance Settings -->
                <div class="settings-section" style="margin-bottom: 16px; padding-bottom: 12px; border-bottom: 1px solid var(--border-color);">
                    <label class="time-label">Appearance</label>
                    <div class="settings-row" style="margin-top: 8px;">
                        <label class="theme-switch-label">
                            <span class="theme-switch-text">Light</span>
                            <label class="theme-switch">
                                <input type="checkbox" id="theme-toggle-checkbox" checked>
                                <span class="theme-slider"></span>
                            </label>
                            <span class="theme-switch-text">Dark</span>
                        </label>
                    </div>
                </div>

                <!-- Ground Track Settings (moved from TIME) -->
                <div class="settings-section">
                    <label class="time-label">Ground Track</label>

                    <div class="track-duration-control">
                        <span class="track-label">Tail</span>
                        <input type="range" class="track-slider" id="track-tail-slider" min="0" max="90" value="45" />
                        <input type="number" class="track-input" id="track-tail-input" min="0" max="90" value="45" />
                        <span class="track-unit">min</span>
                    </div>

                    <div class="track-duration-control">
                        <span class="track-label">Head</span>
                        <input type="range" class="track-slider" id="track-head-slider" min="0" max="90" value="0" />
                        <input type="number" class="track-input" id="track-head-input" min="0" max="90" value="0" />
                        <span class="track-unit">min</span>
                    </div>
                </div>

                <!-- Glow Effect Settings -->
                <div class="settings-section" style="margin-top: 12px;">
                    <label class="time-label">Equator Crossing Glow</label>

                    <div class="settings-row">
                        <label class="settings-toggle-label">
                            <input type="checkbox" id="glow-enabled-checkbox" checked />
                            <span>Show glow effect</span>
                        </label>
                    </div>

                    <div class="track-duration-control">
                        <span class="track-label">Size</span>
                        <input type="range" class="track-slider" id="glow-size-slider" min="20" max="300" value="100" />
                        <span class="track-unit" id="glow-size-value">1.0x</span>
                    </div>

                    <div class="track-duration-control">
                        <span class="track-label">Brightness</span>
                        <input type="range" class="track-slider" id="glow-brightness-slider" min="10" max="200" value="100" />
                        <span class="track-unit" id="glow-brightness-value">1.0x</span>
                    </div>

                    <div class="track-duration-control">
                        <span class="track-label">Fade In</span>
                        <button class="track-step-btn" id="glow-fade-in-down">-</button>
                        <input type="number" class="track-input" id="glow-fade-in-input" min="1" max="30" value="5" style="width: 40px;" />
                        <button class="track-step-btn" id="glow-fade-in-up">+</button>
                        <span class="track-unit">min before</span>
                    </div>

                    <div class="track-duration-control">
                        <span class="track-label">Fade Out</span>
                        <button class="track-step-btn" id="glow-fade-out-down">-</button>
                        <input type="number" class="track-input" id="glow-fade-out-input" min="1" max="30" value="5" style="width: 40px;" />
                        <button class="track-step-btn" id="glow-fade-out-up">+</button>
                        <span class="track-unit">min after</span>
                    </div>
                </div>

                <!-- Apex Tick Pulse Settings -->
                <div class="settings-section" style="margin-top: 12px;">
                    <label class="time-label">Apex Latitude Tick Pulse</label>

                    <div class="settings-row">
                        <label class="settings-toggle-label">
                            <input type="checkbox" id="apex-tick-enabled-checkbox" checked />
                            <span>Show tick marks</span>
                        </label>
                    </div>

                    <div class="track-duration-control">
                        <span class="track-label">Pulse Speed</span>
                        <button class="track-step-btn" id="apex-tick-speed-down">-</button>
                        <input type="number" class="track-input" id="apex-tick-speed-input" min="0.5" max="5" step="0.5" value="1.0" style="width: 45px;" />
                        <button class="track-step-btn" id="apex-tick-speed-up">+</button>
                        <span class="track-unit">Hz</span>
                    </div>

                    <div class="track-duration-control">
                        <span class="track-label">Pulse Width</span>
                        <button class="track-step-btn" id="apex-tick-width-down">-</button>
                        <input type="number" class="track-input" id="apex-tick-width-input" min="1" max="10" step="0.5" value="3.0" style="width: 45px;" />
                        <button class="track-step-btn" id="apex-tick-width-up">+</button>
                        <span class="track-unit">deg</span>
                    </div>

                    <div class="track-duration-control">
                        <span class="track-label">Color</span>
                        <input type="color" id="apex-tick-color-input" value="#FFD700" style="width: 40px; height: 24px; padding: 0; border: 1px solid #555; cursor: pointer;" />
                    </div>

                    <div class="track-duration-control">
                        <span class="track-label">Opacity</span>
                        <input type="range" class="track-slider" id="apex-tick-opacity-input" min="10" max="100" value="80" style="width: 80px;" />
                        <span class="track-unit" id="apex-tick-opacity-value">80%</span>
                    </div>
                </div>

                <!-- Logs Section (moved from main nav) -->
                <div class="settings-section" style="margin-top: 12px; padding-top: 12px; border-top: 1px solid var(--border-color);">
                    <div style="display: flex; align-items: center; justify-content: space-between;">
                        <label class="time-label">Logs</label>
                        <button id="logs-toggle-btn" class="sensor-action-btn" style="padding: 4px 12px; font-size: 11px;">Show</button>
                    </div>
                    <div id="logs-content-inline" style="display: none; margin-top: 8px; max-height: 200px; overflow-y: auto; background: var(--bg-secondary); border-radius: 4px; padding: 8px;">
                        <p style="color: var(--text-muted); font-size: 11px; margin: 0;">Logs coming soon...</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Profile Avatar Section (bottom of control panel) -->
        <div class="profile-section">
            <button class="profile-avatar-btn" id="profile-avatar-btn" title="Manage Profile">
                <span id="profile-avatar-letter">?</span>
            </button>
            <div class="profile-info">
                <span class="profile-name" id="profile-avatar-name">Not logged in</span>
                <span class="profile-role" id="profile-avatar-role">guest</span>
            </div>
        </div>
    </div>

    <!-- 4-Pane Resizable Grid -->
    <div id="main-container">
        <!-- Top-left: Map -->
        <div id="pane-top-left" class="pane">
            <div id="map-container">
                <!-- Deck.gl will create its canvas here -->
                <!-- Current time display overlay (top-left, adjacent to control panel) -->
                <div id="current-time-display" class="current-time-display">
                    <div class="time-row">
                        <span class="time-label">UTC</span>
                        <span class="time-value" id="utc-time-value">--:--:--</span>
                    </div>
                    <div class="time-row">
                        <span class="time-label sim-label">SIM</span>
                        <span class="time-value" id="sim-time-value">--:--:--</span>
                    </div>
                    <div class="time-row zoom-row">
                        <span class="time-label">ZOOM</span>
                        <span class="time-value" id="zoom-level-value">--</span>
                    </div>
                    <div class="time-row">
                        <span class="time-label">SIZE</span>
                        <span class="time-value" id="size-value">--</span>
                    </div>
                    <div class="time-row">
                        <span class="time-label">CTR</span>
                        <span class="time-value" id="center-value">--</span>
                    </div>
                </div>
                <!-- Map maximize button -->
                <button id="map-maximize-btn" title="Maximize map">
                    <span id="maximize-icon"></span>
                </button>
                <!-- Fit Earth button (resize grid + fit) -->
                <button id="map-fit-earth-btn" title="Resize grid to fit Earth (1:1)">
                    <span style="font-size: 12px; font-family: monospace;">[:]</span>
                </button>
                <!-- Map Time Bar (bottom of map) - Compact Responsive Design -->
                <div id="map-time-bar" class="map-time-bar">
                    <!-- Group 1: Time Range -->
                    <div class="mtb-group mtb-window-group">
                        <input type="text" class="mtb-datetime" id="map-time-start" title="Start time (UTC)" placeholder="Start" readonly />
                        <input type="text" class="mtb-datetime" id="map-time-stop" title="Stop time (UTC)" placeholder="Stop" readonly />
                    </div>
                    <!-- Group 2: Transport Controls -->
                    <div class="mtb-group mtb-transport-group">
                        <button class="mtb-btn mtb-anim" id="map-time-rewind" title="Rewind"></button>
                        <button class="mtb-btn mtb-play" id="map-time-play-btn" title="Play/Pause real-time">
                            <span id="map-time-play-icon"></span>
                        </button>
                        <button class="mtb-btn mtb-anim" id="map-time-ffwd" title="Fast Forward"></button>
                    </div>
                    <!-- Group 3: Speed/Step -->
                    <div class="mtb-group mtb-rate-group">
                        <select class="mtb-select mtb-speed" id="map-time-speed-select" title="Playback speed">
                            <option value="1" selected>1</option>
                            <option value="2">2</option>
                            <option value="4">4</option>
                            <option value="10">10</option>
                            <option value="60">60</option>
                        </select>
                        <select class="mtb-select mtb-step" id="map-time-step-select" title="Step size">
                            <option value="0.0167">1s</option>
                            <option value="0.1667">10s</option>
                            <option value="1">1m</option>
                            <option value="5" selected>5m</option>
                            <option value="15">15m</option>
                            <option value="60">1h</option>
                        </select>
                    </div>
                    <!-- Group 4: Slider -->
                    <div class="mtb-group mtb-slider-group">
                        <button class="mtb-btn mtb-step-btn" id="map-time-step-back" title="Step back"></button>
                        <input type="range" class="mtb-slider" id="map-time-slider" min="0" max="1000" value="1000" />
                        <button class="mtb-btn mtb-step-btn" id="map-time-step-forward" title="Step forward"></button>
                        <button class="mtb-btn mtb-now" id="map-time-now-btn" title="Now"></button>
                    </div>

                </div>
            </div>
        </div>

        <!-- Top-right: Polar Plot -->
        <div id="pane-top-right" class="pane">
            <!-- Polar Plot Container (hidden by default) -->
            <div id="polar-plot-container" class="polar-plot-container" style="display: none;">
                <canvas id="polar-plot-canvas"></canvas>
            </div>
            <!-- Placeholder when polar plot not active -->
            <div id="polar-plot-placeholder" class="coming-soon">
                Enable Polar Plot in Analysis panel
            </div>
        </div>

        <!-- Bottom-left: Content + Log Panel -->
        <div id="pane-bottom-left" class="pane">
            <!-- Content area (80%) -->
            <div class="pane-content-area">
                <!-- Lambert Panel Container (hidden by default) -->
                <div id="lambert-panel-container" class="lambert-panel-container" style="display: none;">
                    <div class="lambert-panel-header">
                        <span class="lambert-panel-title">Lambert Transfer Analysis</span>
                    </div>
                    <div class="lambert-panel-content">
                        <!-- Satellite Selection -->
                        <div class="lambert-section">
                            <div class="lambert-field">
                                <label for="lambert-chaser-select">Chaser</label>
                                <select id="lambert-chaser-select" class="lambert-select">
                                    <option value="">-- Select satellite --</option>
                                </select>
                            </div>
                            <div class="lambert-field">
                                <label for="lambert-target-select">Target</label>
                                <select id="lambert-target-select" class="lambert-select">
                                    <option value="">-- Select satellite --</option>
                                </select>
                            </div>
                        </div>

                        <!-- Transfer Parameters -->
                        <div class="lambert-section">
                            <div class="lambert-field">
                                <label for="lambert-tof-input">Time of Flight</label>
                                <div class="lambert-tof-row">
                                    <input type="range" id="lambert-tof-slider" class="lambert-slider" min="600" max="86400" value="3600" step="60">
                                    <input type="number" id="lambert-tof-input" class="lambert-input" min="60" max="604800" value="3600">
                                    <span class="lambert-unit">s</span>
                                </div>
                                <div class="lambert-tof-display" id="lambert-tof-display">1h 0m</div>
                            </div>
                            <div class="lambert-field">
                                <label>Revolutions (M)</label>
                                <div class="lambert-rev-buttons">
                                    <button class="lambert-rev-btn active" data-m="0">0</button>
                                    <button class="lambert-rev-btn" data-m="1">1</button>
                                    <button class="lambert-rev-btn" data-m="2">2</button>
                                    <button class="lambert-rev-btn" data-m="3">3</button>
                                </div>
                            </div>
                        </div>

                        <!-- Compute Button -->
                        <div class="lambert-section">
                            <button id="lambert-compute-btn" class="lambert-compute-btn" disabled>Compute Transfer</button>
                        </div>

                        <!-- Results Display -->
                        <div class="lambert-section lambert-results" id="lambert-results" style="display: none;">
                            <div class="lambert-results-header">Transfer Solution</div>
                            <div class="lambert-result-row">
                                <span class="lambert-result-label">Departure V:</span>
                                <span class="lambert-result-value" id="lambert-departure-dv">--</span>
                            </div>
                            <div class="lambert-result-row">
                                <span class="lambert-result-label">Arrival V:</span>
                                <span class="lambert-result-value" id="lambert-arrival-dv">--</span>
                            </div>
                            <div class="lambert-result-row lambert-result-total">
                                <span class="lambert-result-label">Total V:</span>
                                <span class="lambert-result-value" id="lambert-total-dv">--</span>
                            </div>
                            <div class="lambert-result-row">
                                <span class="lambert-result-label">Transfer type:</span>
                                <span class="lambert-result-value" id="lambert-transfer-type">--</span>
                            </div>
                            <div class="lambert-result-row">
                                <span class="lambert-result-label">Iterations:</span>
                                <span class="lambert-result-value" id="lambert-iterations">--</span>
                            </div>
                        </div>

                        <!-- Status/Error Messages -->
                        <div class="lambert-status" id="lambert-status"></div>
                    </div>
                </div>
                <!-- Placeholder when Lambert not active -->
                <div id="lambert-placeholder" class="coming-soon">Coming Soon 2</div>
            </div>

            <!-- Log panel (20%) -->
            <div class="pane-log-area">
                <!-- Log resize handle (top border) -->
                <div class="log-resize-handle" id="log-resize-handle"></div>
                <!-- Inline controls (top-left overlay) -->
                <div class="log-inline-controls">
                    <button class="log-btn stub" id="log-stub-btn" title="Reserved button (future use)"></button>
                    <button class="log-btn" id="log-clear-btn" title="Clear log display"></button>
                    <button class="log-btn" id="log-download-btn" title="Download log as .txt file"></button>
                    <span class="log-text" id="log-text-placeholder">-</span>
                    <span class="log-text" id="log-count">0</span>
                </div>
                <div class="log-display" id="log-display">
                    <!-- Log entries will be inserted here -->
                </div>
            </div>
        </div>

        <!-- Bottom-right: Coming Soon 3 -->
        <div id="pane-bottom-right" class="pane">
            <div class="coming-soon">Coming Soon 3</div>
        </div>

        <!-- Grid resize handles (borders) -->
        <div class="grid-resize-handle grid-resize-vertical" id="grid-resize-vertical"></div>
        <div class="grid-resize-handle grid-resize-horizontal" id="grid-resize-horizontal"></div>
        <div class="grid-resize-crosshair" id="grid-resize-crosshair">
            <svg width="20" height="20" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
                <!-- 4-point concave star -->
                <path d="M 10,0 Q 10,5 7,7 Q 5,10 0,10 Q 5,10 7,13 Q 10,15 10,20 Q 10,15 13,13 Q 15,10 20,10 Q 15,10 13,7 Q 10,5 10,0 Z"
                      fill="#9dd4ff"
                      stroke="#9dd4ff"
                      stroke-width="0.5"/>
            </svg>
        </div>
    </div>

    <!-- Log Context Menu -->
    <div class="log-context-menu" id="log-context-menu">
        <div class="log-context-item" id="log-context-clear"> Clear</div>
        <div class="log-context-item" id="log-context-download"> Download</div>
    </div>

    <!-- Confirmation Modal -->
    <div class="modal-overlay" id="confirm-modal-overlay">
        <div class="modal-confirm">
            <div class="modal-confirm-title">Delete Sensor(s)</div>
            <div class="modal-confirm-message">Are you sure you want to delete the following sensor(s)?</div>
            <div class="modal-confirm-sensors" id="confirm-modal-sensors"></div>
            <div class="modal-confirm-buttons">
                <button class="modal-confirm-btn modal-confirm-btn-cancel" id="confirm-modal-cancel">Cancel</button>
                <button class="modal-confirm-btn modal-confirm-btn-delete" id="confirm-modal-delete">Delete</button>
            </div>
        </div>
    </div>

    <!-- Editor Modal (Sensors) -->
    <div class="modal-overlay" id="editor-modal-overlay">
        <div class="modal-editor">
            <div class="modal-editor-title" id="editor-modal-title">Add Sensor</div>
            <form class="modal-editor-form" id="editor-modal-form" onsubmit="return false;">
                <div class="modal-editor-field">
                    <label class="modal-editor-label" for="editor-input-name">Name</label>
                    <input type="text" class="modal-editor-input" id="editor-input-name" placeholder="Sensor name" maxlength="20" required>
                </div>
                <div class="modal-editor-field">
                    <label class="modal-editor-label" for="editor-input-lat">Latitude ()</label>
                    <input type="text" class="modal-editor-input" id="editor-input-lat" placeholder="90.0" required>
                </div>
                <div class="modal-editor-field">
                    <label class="modal-editor-label" for="editor-input-lon">Longitude ()</label>
                    <input type="text" class="modal-editor-input" id="editor-input-lon" placeholder="180.0" required>
                </div>
                <div class="modal-editor-field">
                    <label class="modal-editor-label" for="editor-input-alt">Altitude (m)</label>
                    <input type="text" class="modal-editor-input" id="editor-input-alt" placeholder="Meters" required>
                </div>
                <div class="modal-editor-field">
                    <label class="modal-editor-label" for="editor-input-fov">FOV Altitude (km)</label>
                    <input type="text" class="modal-editor-input" id="editor-input-fov" placeholder="500" required>
                </div>
                <div class="modal-editor-buttons">
                    <button type="button" class="modal-editor-btn modal-editor-btn-cancel" id="editor-modal-cancel">Cancel</button>
                    <button type="submit" class="modal-editor-btn modal-editor-btn-save" id="editor-modal-save">Save</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Confirmation Modal (Satellites) -->
    <div class="modal-overlay" id="satellite-confirm-modal-overlay">
        <div class="modal-confirm">
            <div class="modal-confirm-title">Delete Satellite(s)</div>
            <div class="modal-confirm-message">Are you sure you want to delete the following satellite(s)?</div>
            <div class="modal-confirm-sensors" id="satellite-confirm-modal-list"></div>
            <div class="modal-confirm-buttons">
                <button class="modal-confirm-btn modal-confirm-btn-cancel" id="satellite-confirm-modal-cancel">Cancel</button>
                <button class="modal-confirm-btn modal-confirm-btn-delete" id="satellite-confirm-modal-delete">Delete</button>
            </div>
        </div>
    </div>

    <!-- Confirmation Modal (Watch List) -->
    <div class="modal-overlay" id="watchlist-confirm-modal-overlay">
        <div class="modal-confirm">
            <div class="modal-confirm-title">Delete Watch List</div>
            <div class="modal-confirm-message">Are you sure you want to delete this watch list?</div>
            <div class="modal-confirm-sensors" id="watchlist-confirm-modal-name"></div>
            <div class="modal-confirm-buttons">
                <button class="modal-confirm-btn modal-confirm-btn-cancel" id="watchlist-confirm-modal-cancel">Cancel</button>
                <button class="modal-confirm-btn modal-confirm-btn-delete" id="watchlist-confirm-modal-delete">Delete</button>
            </div>
        </div>
    </div>

    <!-- Editor Modal (Satellites) -->
    <div class="modal-overlay" id="satellite-editor-modal-overlay">
        <div class="modal-editor">
            <div class="modal-editor-title" id="satellite-editor-modal-title">Add Satellite</div>
            <form class="modal-editor-form" id="satellite-editor-modal-form" onsubmit="return false;">
                <div class="modal-editor-field">
                    <label class="modal-editor-label" for="satellite-editor-input-name">Name</label>
                    <input type="text" class="modal-editor-input" id="satellite-editor-input-name" placeholder="Satellite name" maxlength="30" required>
                </div>
                <div class="modal-editor-field">
                    <label class="modal-editor-label" for="satellite-editor-input-tle">TLE (Paste both lines)</label>
                    <textarea class="modal-editor-textarea" id="satellite-editor-input-tle" placeholder="1 25544U 98067A   25328.54472231...&#10;2 25544  51.6316 232.5414..." rows="3" required></textarea>
                </div>
                <div class="modal-editor-field">
                    <label class="modal-editor-label">Color</label>
                    <div class="modal-color-picker" id="satellite-editor-color-picker">
                        <button type="button" class="modal-color-btn" data-color="grey" style="background: #666666; border: 2px solid #888888;" title="Grey"></button>
                        <button type="button" class="modal-color-btn" data-color="red" style="background: #ff4444; border: 2px solid #ff6666;" title="Red"></button>
                        <button type="button" class="modal-color-btn" data-color="blue" style="background: #4488ff; border: 2px solid #66aaff;" title="Blue"></button>
                    </div>
                </div>
                <div class="modal-editor-buttons">
                    <button type="button" class="modal-editor-btn modal-editor-btn-cancel" id="satellite-editor-modal-cancel">Cancel</button>
                    <button type="submit" class="modal-editor-btn modal-editor-btn-save" id="satellite-editor-modal-save">Save</button>
                </div>
            </form>
        </div>
    </div>


    <!-- Satellite Add Modal (with Color and List) -->
    <div class="modal-overlay" id="satellite-add-modal-overlay">
        <div class="modal-editor" style="width: 320px;">
            <div class="modal-editor-title" id="satellite-add-modal-title">Add Satellite</div>
            <form class="modal-editor-form" id="satellite-add-modal-form" onsubmit="return false;">
                <div class="modal-editor-field">
                    <label class="modal-editor-label" for="satellite-add-input-name">Name</label>
                    <input type="text" class="modal-editor-input" id="satellite-add-input-name" placeholder="Satellite name" maxlength="30" required>
                </div>
                <div class="modal-editor-field">
                    <label class="modal-editor-label" for="satellite-add-input-tle">TLE (Paste both lines)</label>
                    <textarea class="modal-editor-textarea" id="satellite-add-input-tle" placeholder="1 25544U 98067A   25328.54472231...&#10;2 25544  51.6316 232.5414..." rows="3" required></textarea>
                </div>
                <div class="modal-editor-field">
                    <label class="modal-editor-label">Color</label>
                    <div class="modal-color-picker" id="satellite-add-color-picker">
                        <button type="button" class="modal-color-btn" data-color="grey" style="background: #666666; border: 2px solid #888888;" title="Grey"></button>
                        <button type="button" class="modal-color-btn active" data-color="red" style="background: #ff4444; border: 2px solid #ff6666;" title="Red"></button>
                        <button type="button" class="modal-color-btn" data-color="blue" style="background: #4488ff; border: 2px solid #66aaff;" title="Blue"></button>
                    </div>
                </div>
                <div class="modal-editor-field">
                    <label class="modal-editor-label" for="satellite-add-input-list">Add to List</label>
                    <select class="modal-editor-select" id="satellite-add-input-list">
                        <option value="">(None)</option>
                        <!-- Populated by JavaScript -->
                    </select>
                </div>
                <div class="modal-editor-buttons">
                    <button type="button" class="modal-editor-btn modal-editor-btn-cancel" id="satellite-add-modal-cancel">Cancel</button>
                    <button type="submit" class="modal-editor-btn modal-editor-btn-save" id="satellite-add-modal-save">Save</button>
                </div>
            </form>
        </div>
    </div>

    <!-- List Editor Modal (with Satellite Picker) -->
    <div class="modal-overlay" id="list-editor-modal-overlay">
        <div class="modal-editor" style="width: 500px; height: 500px; max-height: 80vh; display: flex; flex-direction: column;">
            <div class="modal-editor-title" id="list-editor-modal-title">Create List</div>
            <form class="modal-editor-form" id="list-editor-modal-form" onsubmit="return false;" style="flex: 1; display: flex; flex-direction: column; min-height: 0;">
                <div class="modal-editor-field">
                    <label class="modal-editor-label" for="list-editor-input-name">List Name</label>
                    <input type="text" class="modal-editor-input" id="list-editor-input-name" placeholder="My Favorites" maxlength="30" required>
                </div>
                <div class="modal-editor-field" style="flex: 1; display: flex; flex-direction: column; min-height: 0;">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 6px;">
                        <label class="modal-editor-label" style="margin: 0;">Select Satellites</label>
                        <span id="list-editor-sat-count" style="font-size: 10px; color: var(--text-muted);">0 selected</span>
                    </div>
                    <div style="display: flex; gap: 6px; margin-bottom: 6px;">
                        <input type="text" class="modal-editor-input" id="list-editor-search" placeholder="Search by name, NORAD ID, or catalog..." style="flex: 1; font-size: 11px;">
                        <label style="display: flex; align-items: center; gap: 4px; font-size: 10px; white-space: nowrap; cursor: pointer;">
                            <input type="checkbox" id="list-editor-selected-only"> Selected only
                        </label>
                    </div>
                    <div class="modal-table-header" id="list-editor-headers" style="display: flex; font-size: 10px; padding: 4px 0; border-bottom: 1px solid var(--border-color); color: var(--text-muted);">
                        <div id="list-editor-header-sel" class="modal-header-col sortable" style="width: 30px; text-align: center; cursor: pointer;" title="Click to select/deselect all">Sel</div>
                        <div id="list-editor-header-norad" class="modal-header-col sortable" style="width: 55px; text-align: center; cursor: pointer;" title="Click to sort">NORAD</div>
                        <div id="list-editor-header-name" class="modal-header-col sortable" style="flex: 1; padding: 0 6px; cursor: pointer;" title="Click to sort">Name</div>
                        <div id="list-editor-header-catalog" class="modal-header-col sortable" style="width: 80px; text-align: right; padding-right: 4px; cursor: pointer;" title="Click to sort">Catalog</div>
                    </div>
                    <div style="position: relative; flex: 1; min-height: 0; display: flex; flex-direction: column;">
                        <div class="modal-satellite-picker" id="list-editor-satellite-picker" style="flex: 1; min-height: 0;">
                            <!-- Populated by JavaScript with virtual scrolling -->
                        </div>
                        <div id="list-editor-loading" class="list-editor-loading" style="display: none;">
                            <div class="list-editor-loading-content">
                                <div class="list-editor-spinner"></div>
                                <span id="list-editor-loading-text">Loading...</span>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-editor-buttons">
                    <button type="button" class="modal-editor-btn modal-editor-btn-delete" id="list-editor-modal-delete" style="display: none; background: #cc4444; color: white;">Delete</button>
                    <button type="button" class="modal-editor-btn modal-editor-btn-cancel" id="list-editor-modal-cancel">Cancel</button>
                    <button type="submit" class="modal-editor-btn modal-editor-btn-save" id="list-editor-modal-save">Save</button>
                </div>
            </form>
        </div>
    </div>



    <!-- Catalog Add Modal (for TLE paste) -->
    <div class="modal-overlay" id="catalog-add-modal-overlay">
        <div class="modal-editor" style="width: 400px; max-height: 80vh;">
            <div class="modal-editor-title" id="catalog-add-modal-title">Create Catalog</div>
            <form class="modal-editor-form" id="catalog-add-modal-form" onsubmit="return false;">
                <div class="modal-editor-field">
                    <label class="modal-editor-label" for="catalog-add-input-name">Catalog Name</label>
                    <input type="text" class="modal-editor-input" id="catalog-add-input-name" placeholder="My Satellites" maxlength="30" required>
                </div>
                <div class="modal-editor-field">
                    <label class="modal-editor-label" for="catalog-add-input-tle">TLE Data (paste multiple satellites)</label>
                    <textarea class="modal-editor-input" id="catalog-add-input-tle" placeholder="SATELLITE NAME
1 XXXXX...
2 XXXXX...
SATELLITE NAME 2
1 XXXXX...
2 XXXXX..." style="height: 200px; font-family: monospace; font-size: 11px; resize: vertical;"></textarea>
                </div>
                <p style="color: var(--text-muted); font-size: 9px; margin: 4px 0 12px 0;">
                    Format: 3 lines per satellite (name, line 1, line 2)
                </p>
                <div class="modal-editor-buttons">
                    <button type="button" class="modal-editor-btn modal-editor-btn-cancel" id="catalog-add-modal-cancel">Cancel</button>
                    <button type="submit" class="modal-editor-btn modal-editor-btn-save" id="catalog-add-modal-save">Save</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Catalog Edit Modal (two-panel satellite editor) -->
    <div class="modal-overlay" id="catalog-edit-modal-overlay">
        <div class="modal-catalog-edit">
            <div class="modal-catalog-edit-header">
                <input type="text" class="modal-catalog-edit-title-input" id="catalog-edit-name-input" placeholder="Catalog Name">
                <button type="button" class="modal-editor-btn modal-editor-btn-save" id="catalog-edit-save-name-btn" style="padding: 4px 8px; font-size: 10px; margin-right: 8px;">Save</button>
                <button type="button" class="modal-catalog-edit-close" id="catalog-edit-close">&times;</button>
            </div>
            <div class="modal-catalog-edit-body">
                <!-- Left Panel: Satellite Table (Virtual Scrolling) -->
                <div class="modal-catalog-edit-left">
                    <div class="modal-catalog-edit-table-header">
                        <span id="catalog-edit-sat-count">0 satellites</span>
                        <button type="button" class="modal-catalog-edit-add-btn" id="catalog-edit-add-sat">+Sat</button>
                    </div>
                    <div style="padding: 4px 8px;">
                        <input type="text" class="modal-editor-input" id="catalog-edit-search" placeholder="Search by name or NORAD ID..." style="width: 100%; font-size: 11px; padding: 4px 8px;">
                    </div>
                    <div class="modal-table-header" id="catalog-edit-headers" style="font-size: 10px; padding: 4px 0; border-bottom: 1px solid var(--border-color); display: flex; color: var(--text-muted);">
                        <div id="catalog-edit-header-color" class="modal-header-col" style="width: 30px; text-align: center;">Color</div>
                        <div id="catalog-edit-header-norad" class="modal-header-col sortable" style="width: 60px; text-align: center; cursor: pointer;" title="Click to sort">NORAD</div>
                        <div id="catalog-edit-header-name" class="modal-header-col sortable" style="flex: 1; padding: 0 8px; cursor: pointer;" title="Click to sort">Name</div>
                        <div id="catalog-edit-header-lists" class="modal-header-col" style="width: 40px; text-align: center;">Lists</div>
                    </div>
                    <div class="modal-catalog-edit-table-container" id="catalog-edit-table-container" style="flex: 1; min-height: 0; overflow: hidden;">
                        <!-- Virtual scrolling content populated by JavaScript -->
                    </div>
                    <div class="modal-catalog-edit-help">
                        Click row to edit  Scroll for more
                    </div>
                </div>
                <!-- Right Panel: Satellite Detail Editor -->
                <div class="modal-catalog-edit-right" id="catalog-edit-detail-panel">
                    <div class="modal-catalog-edit-detail-placeholder">
                        Select a satellite to view/edit details
                    </div>
                    <!-- Detail form (hidden until satellite selected) -->
                    <form class="modal-catalog-edit-detail-form" id="catalog-edit-detail-form" style="display: none;">
                        <div class="modal-editor-field">
                            <label class="modal-editor-label">Satellite Name</label>
                            <input type="text" class="modal-editor-input" id="catalog-edit-sat-name" placeholder="Satellite Name">
                        </div>
                        <div class="modal-editor-field">
                            <label class="modal-editor-label">NORAD ID</label>
                            <input type="text" class="modal-editor-input" id="catalog-edit-sat-norad" placeholder="NORAD ID" readonly style="background: var(--input-bg-disabled); color: var(--text-muted);">
                        </div>
                        <div class="modal-editor-field">
                            <label class="modal-editor-label">TLE Data</label>
                            <textarea class="modal-editor-input modal-editor-textarea" id="catalog-edit-sat-tle" placeholder="1 XXXXX...
2 XXXXX..." style="height: 70px; font-family: monospace; font-size: 10px;"></textarea>
                        </div>
                        <div class="modal-editor-field">
                            <label class="modal-editor-label">Display Color</label>
                            <div class="modal-color-picker" id="catalog-edit-color-picker">
                                <button type="button" class="modal-color-btn" data-color="grey" style="background: #666666; border: 2px solid #888888;" title="Grey"></button>
                                <button type="button" class="modal-color-btn" data-color="red" style="background: #ff4444; border: 2px solid #ff6666;" title="Red"></button>
                                <button type="button" class="modal-color-btn" data-color="blue" style="background: #4488ff; border: 2px solid #66aaff;" title="Blue"></button>
                            </div>
                        </div>
                        <div class="modal-editor-field">
                            <label class="modal-editor-label">Watch Lists</label>
                            <div class="modal-catalog-edit-lists" id="catalog-edit-lists-container">
                                <!-- Populated by JavaScript -->
                            </div>
                        </div>
                        <div class="modal-catalog-edit-detail-buttons">
                            <button type="button" class="modal-editor-btn modal-editor-btn-delete" id="catalog-edit-delete-sat">Delete</button>
                            <button type="button" class="modal-editor-btn modal-editor-btn-cancel" id="catalog-edit-cancel-sat">Cancel</button>
                            <button type="submit" class="modal-editor-btn modal-editor-btn-save" id="catalog-edit-save-sat">Save</button>
                        </div>
                    </form>
                </div>
            </div>
            <div class="modal-catalog-edit-footer">
                <button type="button" class="modal-editor-btn modal-editor-btn-cancel" id="catalog-edit-close-btn">Close</button>
            </div>
        </div>
    </div>

    <!-- Profile Defaults Modal -->
    <div class="modal-overlay" id="profile-defaults-modal-overlay">
        <div class="modal-editor" style="width: 500px; max-height: 80vh; overflow-y: auto;">
            <div class="modal-editor-title">Profile Defaults</div>
            <div class="modal-editor-form" id="profile-defaults-form">
                <div class="modal-editor-field" style="border-bottom: 1px solid var(--border-color); padding-bottom: 12px; margin-bottom: 12px;">
                    <label class="modal-editor-label" style="font-weight: 600;">Appearance</label>
                    <div style="display: flex; align-items: center; gap: 10px;">
                        <label style="font-size: 11px;">Theme:</label>
                        <select id="profile-default-theme" class="modal-editor-input" style="width: auto;">
                            <option value="dark">Dark</option>
                            <option value="light">Light</option>
                        </select>
                    </div>
                </div>
                <div class="modal-editor-field" style="border-bottom: 1px solid var(--border-color); padding-bottom: 12px; margin-bottom: 12px;">
                    <label class="modal-editor-label" style="font-weight: 600;">Ground Track</label>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px;">
                        <div><label style="font-size: 10px;">Tail (min)</label><input type="number" id="profile-default-tail" class="modal-editor-input" min="0" max="90" value="45"></div>
                        <div><label style="font-size: 10px;">Head (min)</label><input type="number" id="profile-default-head" class="modal-editor-input" min="0" max="90" value="0"></div>
                    </div>
                </div>
                <div class="modal-editor-field" style="border-bottom: 1px solid var(--border-color); padding-bottom: 12px; margin-bottom: 12px;">
                    <label class="modal-editor-label" style="font-weight: 600;">Glow Effect</label>
                    <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 8px;">
                        <input type="checkbox" id="profile-default-glow-enabled" checked>
                        <label for="profile-default-glow-enabled" style="font-size: 11px;">Enable Glow</label>
                    </div>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px;">
                        <div><label style="font-size: 10px;">Size</label><input type="number" id="profile-default-glow-size" class="modal-editor-input" min="0.2" max="3" step="0.1" value="1.0"></div>
                        <div><label style="font-size: 10px;">Brightness</label><input type="number" id="profile-default-glow-intensity" class="modal-editor-input" min="0.1" max="2" step="0.1" value="1.0"></div>
                        <div><label style="font-size: 10px;">Fade In</label><input type="number" id="profile-default-glow-fade-in" class="modal-editor-input" min="1" max="30" value="5"></div>
                        <div><label style="font-size: 10px;">Fade Out</label><input type="number" id="profile-default-glow-fade-out" class="modal-editor-input" min="1" max="30" value="5"></div>
                    </div>
                </div>
                <div class="modal-editor-field" style="border-bottom: 1px solid var(--border-color); padding-bottom: 12px; margin-bottom: 12px;">
                    <label class="modal-editor-label" style="font-weight: 600;">Apex Tick</label>
                    <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 8px;">
                        <input type="checkbox" id="profile-default-apex-enabled" checked>
                        <label for="profile-default-apex-enabled" style="font-size: 11px;">Enable</label>
                    </div>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px;">
                        <div><label style="font-size: 10px;">Speed</label><input type="number" id="profile-default-apex-speed" class="modal-editor-input" min="0.5" max="5" step="0.5" value="1.0"></div>
                        <div><label style="font-size: 10px;">Width</label><input type="number" id="profile-default-apex-width" class="modal-editor-input" min="1" max="10" step="0.5" value="3.0"></div>
                        <div><label style="font-size: 10px;">Color</label><input type="color" id="profile-default-apex-color" class="modal-editor-input" value="#ff6600"></div>
                        <div><label style="font-size: 10px;">Opacity</label><input type="number" id="profile-default-apex-opacity" class="modal-editor-input" min="10" max="100" value="80"></div>
                    </div>
                </div>
                <div class="modal-editor-field" style="border-bottom: 1px solid var(--border-color); padding-bottom: 12px; margin-bottom: 12px;">
                    <label class="modal-editor-label" style="font-weight: 600;">Map View</label>
                    <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 10px;">
                        <div><label style="font-size: 10px;">Lon</label><input type="number" id="profile-default-map-lon" class="modal-editor-input" min="-180" max="180" value="0"></div>
                        <div><label style="font-size: 10px;">Lat</label><input type="number" id="profile-default-map-lat" class="modal-editor-input" min="-90" max="90" value="0"></div>
                        <div><label style="font-size: 10px;">Zoom</label><input type="number" id="profile-default-map-zoom" class="modal-editor-input" min="1" max="18" value="2"></div>
                    </div>
                </div>
                <div class="modal-editor-field" style="border-bottom: 1px solid var(--border-color); padding-bottom: 12px; margin-bottom: 12px;">
                    <label class="modal-editor-label" style="font-weight: 600;">Canvas Size</label>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px;">
                        <div><label style="font-size: 10px;">Width (px)</label><input type="number" id="profile-default-canvas-width" class="modal-editor-input" min="800" max="7680" value="1920"></div>
                        <div><label style="font-size: 10px;">Height (px)</label><input type="number" id="profile-default-canvas-height" class="modal-editor-input" min="600" max="4320" value="1080"></div>
                    </div>
                </div>
                <div class="modal-editor-field">
                    <label class="modal-editor-label" style="font-weight: 600;">Default Watch List</label>
                    <div style="display: flex; align-items: center; gap: 10px;">
                        <select id="profile-default-watchlist" class="modal-editor-input" style="flex: 1;">
                            <option value="">(None)</option>
                        </select>
                    </div>
                </div>
                <div class="modal-editor-buttons">
                    <button type="button" class="modal-editor-btn cancel" id="profile-defaults-cancel">Cancel</button>
                    <button type="button" class="modal-editor-btn delete" id="profile-defaults-reset" style="background: var(--accent-orange);">Reset</button>
                    <button type="button" class="modal-editor-btn save" id="profile-defaults-save">Save</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Login Modal -->
    <div class="modal-overlay" id="login-modal-overlay">
        <div class="modal-editor" style="width: 280px;">
            <div class="modal-editor-title" id="login-modal-title">Login</div>
            <form class="modal-editor-form" id="login-modal-form" onsubmit="return false;">
                <div class="modal-editor-field">
                    <label class="modal-editor-label" for="login-input-username">Username</label>
                    <input type="text" class="modal-editor-input" id="login-input-username" placeholder="default" autocomplete="username">
                </div>
                <div class="modal-editor-field">
                    <label class="modal-editor-label" for="login-input-password">Password</label>
                    <input type="password" class="modal-editor-input" id="login-input-password" placeholder="password" autocomplete="current-password">
                </div>
                <div class="modal-editor-field" id="login-error-field" style="display: none;">
                    <span style="color: var(--accent-red); font-size: 10px;" id="login-error-message"></span>
                </div>
                <div class="modal-editor-buttons">
                    <button type="button" class="modal-editor-btn modal-editor-btn-cancel" id="login-modal-cancel">Skip</button>
                    <button type="submit" class="modal-editor-btn modal-editor-btn-save" id="login-modal-submit">Login</button>
                </div>
            </form>
            <div style="margin-top: 8px; text-align: center; font-size: 9px; color: var(--text-muted);">
                Default: default / default
            </div>
        </div>
    </div>

    <!-- ES6 Module Loading -->
    <script type="module" src="/static/app.js?v=100"></script>

    <!-- Fallback for browsers without ES6 module support -->
    <script nomodule>
        alert(' Your browser does not support ES6 modules.\n\nPlease upgrade to:\n Chrome 61+\n Firefox 60+\n Safari 10.1+\n Edge 16+');
        console.error('ES6 modules not supported. Please upgrade your browser.');
    </script>

    <!-- Module load error handler -->
    <script type="module">
        // Global error handler for module loading failures
        window.addEventListener('error', (e) => {
            if (e.message && e.message.includes('module')) {
                console.error(' Module loading failed:', e);
                console.error('Error details:', {
                    message: e.message,
                    filename: e.filename,
                    lineno: e.lineno,
                    colno: e.colno
                });

                // Show user-friendly error message
                const errorDiv = document.createElement('div');
                errorDiv.style.cssText = `
                    position: fixed;
                    top: 50%;
                    left: 50%;
                    transform: translate(-50%, -50%);
                    background: #ff4444;
                    color: white;
                    padding: 20px;
                    border-radius: 8px;
                    font-family: system-ui, sans-serif;
                    font-size: 11px;
                    max-width: 400px;
                    z-index: 10000;
                    box-shadow: 0 4px 12px rgba(0,0,0,0.5);
                `;
                errorDiv.innerHTML = `
                    <strong> Module Loading Failed</strong><br><br>
                    The application failed to load properly.<br><br>
                    <strong>Possible causes:</strong><br>
                     Network connection issue<br>
                     Backend server not running<br>
                     File not found<br><br>
                    <strong>To fix:</strong><br>
                    1. Check that backend is running<br>
                    2. Refresh the page (Ctrl+R)<br>
                    3. Check browser console for details
                `;
                document.body.appendChild(errorDiv);
            }
        });

        // Check if critical modules loaded
        window.addEventListener('load', () => {
            // Module loading successful
            console.log(' ES6 modules loaded successfully');
        });
    </script>
</body>
</html>
